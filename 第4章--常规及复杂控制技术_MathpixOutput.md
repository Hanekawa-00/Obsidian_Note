# 第4章  常规及复杂控制技术

计算机控制系统的设计, 是指在给定系统性能指标的条件下, 设计出控制器的控制规律和相应的数字控制算法。本章主要介绍计算机控制系统的常规及复杂控制技术。常规控制技术介绍数字控制器的连续化设计技术和离散化设计技术；复杂控制技术介绍纯滞后控制、串级控制、前馈一反馈控制、解耦控制等技术。对大多数系统，采用常规控制技术均可达到满意的控制效果，但对于复杂及有特殊控制要求的系统，采用常规控制技术难以达到目的，在这种情况下，则需要采用复杂控制技术，甚至采用现代控制和智能控制技术。
4.1 数字控制器的连续化设计技术

数字控制器的连续化设计是忽略控制回路中所有的零阶保持器和采样器, 在 $S$ 域中按连续系统进行初步设计, 求出连续控制器, 然后通过某种近似, 将连续控制器离散化为数字控制器，并由计算机来实现。由于广大工程技术人员对 $S$ 平面比 $Z$ 平面更为熟悉，因此数字控制器的连续化设计技术被广泛采用。
4.1.1 数字控制器的连续化设计步骤

在图 4-1 所示的计算机控制系统中， $G(s)$ 是被控对象的传递函数， $H(s)$ 是零阶保持器， $D(z)$是数字控制器。现在的设计问题是: 根据已知的系统性能指标和 $G(s)$ 来设计出数字控制器 $D(z)$ 。

图 4-1 计算机控制系统的结构图

1. 设计假想的连续控制器 $D(s)$

由于人们对连续系统的设计方法比较熟悉，因此，可先对图 4-2 所示的假想的连续控制系统进行设计，如利用连续系统的频率特性法、根轨迹法等设计出假想的连续控制器 $D(s)$ 。关于连续系统设计 $D(s)$ 的各种方法可参考有关自动控制原理方面的资料，这里不再讨论。

图4-2 假想的连续控制系统结构图

2. 选择采样周期 $T$

香农采样定理给出了从采样信号恢复连续信号的最低采样频率。在计算机控制系统中，完成信号恢复功能一般由零阶保持器 $\boldsymbol{H}(s)$ 来实现。零阶保持器的传递函数为

$$
H(s)=\frac{1-\mathrm{e}^{-s T}}{s}
$$

（4-1）
其频率特性为

$$
H(\mathrm{j} \omega)=\frac{1-\mathrm{e}^{-\rho \omega T}}{\mathrm{j} \omega}=T \frac{\sin \frac{\omega T}{2}}{\frac{\omega T}{2}} \angle-\frac{\omega T}{2}
$$

（4-2）
从式（4-2）可以看出，零阶保持器将对控制信号产生附加相移（滞后）。对于小的采样周期, 可把零阶保持器 $H(s)$ 近似为

$$
\begin{array}{l}
H(s)=\frac{1-\mathrm{e}^{-s T}}{s} \approx \frac{1-1+s T-\frac{(s T)^{2}}{2}+\cdots}{s} \\
\quad=T\left(1-s \frac{T}{2}+\cdots\right) \approx T \mathrm{e}^{-\frac{r}{2}}
\end{array}
$$

（4-3）
式（4-3）表明，零阶保持器 $H(s)$ 可用半个采样周期的时间滞后环节来近似。假定相位裕量可减少 $5^{\circ} \sim 15^{\circ}$, 则采样周期应选为

$$
T \approx(0.15 \sim 0.5) \frac{1}{\omega_{\mathrm{c}}}
$$

（4-4）
式中， $\omega_{\mathrm{c}}$ 是连续控制系统的前切频率。
按式（4-4）的经验法选择的采样周期相当短。因此，采用连续化设计方法，用数字控制器去近似连续控制器，要有相当短的采样周期。
3. 将 $D(s)$ 离散化为 $D(z)$

将连续控制器 $D(s)$ 离散化为数字控制器 $D(z)$ 的方法有很多，如双线性变换法、后向差分法、前向差分法、冲击响应不变法、零极点匹配法、零阶保持法等。在这里，只介绍常用的双线性变换法、后向差分法和前向差分法。
（1）双线性变换法
由 $Z$ 变换的定义可知， $z=\mathrm{e}^{s T}$ ，利用级数展开可得

$$
z=\mathrm{e}^{s T}=\frac{\mathrm{e}^{\frac{s T}{2}}}{\mathrm{e}^{\frac{-s,}{2}}}=\frac{1+\frac{s T}{2}+\cdots}{1-\frac{s T}{2}+\cdots} \approx \frac{1+\frac{s T}{2}}{1-\frac{s T}{2}}
$$

（4-5）
式（4-5）称为双线性变换或塔斯廷（Tustin）近似。
为了由 $D(s)$ 求解 $D(z)$ ，由式（4-5）可得

$$
s = \frac{2}{T} \frac{z-1}{z+1}
$$
（4-6）
且有
$$
D(z)=\left.D(s)\right|_{s = \frac{2}{T} \frac{z-1}{z+1}}
$$
（4-7）
式（4-7）就是利用双线性变换法由 $D(s)$ 求取 $D(z)$ 的计算公式。
双线性变换也可从数值积分的梯形法对应得到。设积分控制规律为
$$
u(t)=\int_{0}^{t} e(t) \mathrm{d} t
$$
（4-8）
式（4-8）两边求拉普拉斯变换后可推导得出控制器为
$$
D(s)=\frac{U(s)}{E(s)}=\frac{1}{s}
$$
（4-9）
当用梯形法求积分运算可得算式如下
$$
u(k)=u(k-1)+\frac{T}{2}[e(k)-e(k-1)]
$$
（4-10）
式（4-10） 两边求 $Z$ 变换后可推导得出数字控制器为
$$
D(z)=\frac{U(z)}{E(z)}=\frac{1}{，。\frac{2}{T} \frac{z-1}{z+1}}=\left.D(s)\right|_{s = \frac{2}{T} \frac{z-1}{z+1}}
$$
（4-11）
（2）前向差分法
利用级数展开可将 $z=\mathrm{e}^{s T}$ 写成以下形式
$$
z=\mathrm{e}^{s T}=1+s T+\cdots \approx 1+s T
$$
（4-12）
式（4-12）称为前向差分法或欧拉法的计算公式。为了由 $D(s)$ 求取 $D(z)$ ，由式（4-12） 可得
$$
s=\frac{z-1}{T}
$$
（4-13）
且
$$
D(z)=\left.D(s)\right|_{s=\frac{z-1}{T}}
$$
（4-14）
式（4-14）便是前向差分法由 $D(s)$ 求取 $D(z)$ 的计算公式。
前向差分法也可由数值微分中得到。设微分控制规律为
$$
u(t)=\frac{\mathrm{d} e(t)}{\mathrm{d} t}
$$
（4-15）
上式两边求拉普拉斯变换后可推导出控制器为
$$
D(s)=\frac{U(s)}{E(s)}=s
$$
（4-16）
对式（4-15）采用前向差分近似可得
$$
u(k) \approx \frac{e(k+1)-e(k)}{T}
$$
（4-17）
式 (4-17) 两边求 $Z$ 变换后可推导出数字控制器为
$$
D(z)=\frac{U(z)}{E(z)}=\frac{z-1}{T}=\left.D(s)\right|_{s=\frac{z-1}{T}}
$$
（4-18）
（3）后向差分法
利用级数展开还可将 $z=\mathrm{e}^{s T}$ 写成以下形式
$$
z=\mathrm{e}^{s T}=\frac{1}{\mathrm{e}^{-s T}} \approx \frac{1}{1-s T}
$$
（4-19）
由式（4-19）可得
$$
s=\frac{z-1}{T z}
$$
（4-20）
且有
$$
D(z)=\left.D(s)\right|_{s=\frac{z-1}{T_{z}}}
$$
（4-21）
式（4-21）便是利用后向差分法求取 $D(z)$ 的计算公式。
后向差分法也同样可由数值微分计算中得到。对式（4-15）采用后向差分近似可得
$$
u(k) \approx \frac{e(k)-e(k-1)}{T}
$$
(4-22)
式 (4-22) 两边求 $Z$ 变换后可推得数字控制器为
$$
D(z)=\frac{U(z)}{E(z)}=\frac{z-1}{T z}=\left.D(s)\right|_{s=\frac{z-1}{T z}}
$$
(4-23)
双线性变换的优点在于，它把左半 $S$ 平面转换到单位圆内。如果使用双线性变换，一个稳定的连续控制系统在变换之后仍将是稳定的，可是使用前向差分法，就可能把它变换为一个不稳定的离散控制系统。
4. 设计由计算机实现的控制算法
设数字控制器 $D(z)$ 的一般形式为
$$
D(z)=\frac{U(z)}{E(z)}=\frac{b_{0}+b_{1} z^{-1}+\cdots+b_{m} z^{-m}}{1+a_{1} z^{-1}+\cdots+a_{n} z^{-n}}
$$
(4-24)
式中, $n \geqslant m$, 各系数 $a_{i} 、 b_{i}$ 为实数, 且有 $n$ 个极点和 $m$ 个零点。
式 (4-24) 可写为
$$
U(z)=\left(-a_{1} z^{-1}-a_{2} z^{-2}-\cdots-a_{n} z^{-n}\right) U(z)+\left(b_{0}+b_{1} z^{-1}+b_{2} z^{-2}+\cdots+b_{m} z^{-m}\right) E(z)
$$
上式用时域表示为
$$
\begin{aligned}
u(k)= & -a_{1} u(k-1)-a_{2} u(k-2)-\cdots-a_{n} u(k-n) \\
& +b_{0} e(k)+b_{1} e(k-1)+\cdots+b_{m} e(k-m)
\end{aligned}
$$
(4-25)
利用式（4-25）即可实现计算机编程，因此，式（4-25）称为数字控制器 $D(z)$ 的控制算法。
5. 校验

控制器 $D(z)$ 设计完并求出控制算法后，须按图 4-1 所示的计算机控制系统检验其闭环特性是否符合设计要求，这一步可由计算机控制系统的数字仿真计算来验证，如果满足设计要求设计结束，否则应修改设计。
4. 1.2 数字 PID 控制器的设计

根据偏差的比例（P）、积分（I）、微分（D）进行控制（简称 PID 控制），是控制系统中应用最为广泛的一种控制规律。实际运行的经验和理论分析都表明，使用这种控制规律对许多工业过程进行控制时, 都能得到满意的效果。不过, 用计算机实现 PID 控制, 不是简单地把模拟 PID 控制规律数字化，而是进一步与计算机的逻辑判断功能结合，使 PID 控制更加灵活，更能满足生产过程提出的要求。

1. 模拟 PID 调节器

在工业控制系统中，常常采用如图 4-3 所示的 PID 控制，其控制规律为

$$
u(t)=K_{\mathrm{p}}\left[e(t)+\frac{1}{T_{\mathrm{I}}} \int_{0}^{t} e(t) \mathrm{d} t+T_{\mathrm{D}} \frac{\mathrm{~d} e(t)}{\mathrm{d} t}\right]
$$

(4-26)
对应的模拟 PID 调节器的传递函数为
图4-3 模拟 PID 控制系统

$$
D(s)=\frac{U(s)}{E(s)}=K_{\mathrm{P}}\left(1+\frac{1}{T_{1} s}+T_{\mathrm{D}} s\right)
$$

(4-27)
式中, $K_{\mathrm{P}}$ 为比例增益, $K_{\mathrm{P}}$ 与比例带 $\delta$ 成倒数关系即 $K_{\mathrm{P}}=1 / \delta$;
$T_{1}$ 为积分时间常数， $T_{\mathrm{D}}$ 为微分时间常数；
$u(t)$ 为控制量； $e(t)$ 为偏差。
比例控制能迅速反应误差，从而减小误差，但比例控制不能消除稳态误差， $K_{p}$ 的加大会引起系统的不稳定；积分控制的作用是，只要系统存在误差，积分控制作用就不断地积累，输出控制量以消除误差，因而，只要有足够的时间，积分控制将能完全消除误差，积分作用太强会使系统超调加大，甚至使系统出现振荡；微分控制可以减小超调量，克服振荡，使系统的稳定性提高，同时加快系统的动态响应速度，减小调整时间，从而改善系统的动态性能。
2. 数字 PID 控制器

在计算机控制系统中，PID 控制规律的实现必须用数值逼近的方法。当采样周期相当短时，用求和代替积分、用后向差分代替微分，使模拟 PID 离散化变为差分方程。
（1）数字 PID 位置型控制算法
为了便于计算机实现，必须把式（4-26）变换成差分方程，为此可作如下近似

$$
\begin{array}{c}
\int_{0}^{t} e(t) \mathrm{d} t \approx \sum_{i}^{k} T e(i) （4-28） \\ 
\frac{\mathrm{d} e(t)}{\mathrm{d} t} \approx \frac{e(k)-e(k-1)}{T} （4-29）
\end{array}
$$

式中， $T$ 为采样周期；
$k$ 为采样序号。
由式（4-26）、式（4-28）和式（4-29）可得数字 PID 位置型控制算式为

$$
u(k)=K_{\mathrm{P}}\left[e(k)+\frac{T}{T_{1}} \sum_{i=0}^{k} e(i)+T_{\mathrm{D}} \frac{e(k)-e(k-1)}{T}\right]
$$

（4-30）
式（4-30）表示的控制算法提供了执行机构的位置 $u(k)$ ，如阀门的开度，所以被称为数字 PID 位置型控制算式。
（2）数字 PID 增量型控制算法
由式（4-30）可看出，位置型控制算式不够方便，这是因为要累加偏差 $e(i)$ ，不仅要占用较多的存储单元，而且不便于编写程序，为此可对式（4-30）进行改进。

根据式（4-30）不难写出 $u(k-1)$ 的表达式，即

$$
u(k-1)=K_{\mathrm{P}}\left[e(k-1)+\frac{T}{T_{1}} \sum_{i=0}^{k-1} e(i)+T_{\mathrm{D}} \frac{e(k-1)-e(k-2)}{T}\right]
$$

（4-31）
将式（4-30）和式（4-31）相减，即得数字 PID 增量型控制算式为

$$
\begin{aligned}
\Delta u(k) & =u(k)-u(k-1) \\
& =K_{\mathrm{p}}[e(k)-e(k-1)]+K_{\mathrm{I}} e(k)+K_{\mathrm{D}}[e(k)-2 e(k-1)+e(k-2)]
\end{aligned}
$$

（4-32）
式中, $K_{\mathrm{P}}$ 为比例增益, $K_{\mathrm{P}}=1 / \sigma ; K_{\mathrm{I}}$ 为积分系数, $K_{\mathrm{I}}=K_{\mathrm{P}} T / T_{1} ; K_{\mathrm{D}}$ 为微分系数, $K_{\mathrm{D}}=K_{\mathrm{P}} T_{\mathrm{D}} / T_{\mathrm{O}}$为了编程方便，可将式（4-32）整理成如下形式

$$
\begin{array}{l} 
\Delta u(k)= q_{0} e(k)+q_{1} e(k-1)+q_{2} e(k-2)  （4-33）\\
\left\{\begin{array}{l}
q_{0}=K_{\mathrm{P}}\left(1+\frac{T}{T_{1}}+\frac{T_{\mathrm{D}}}{T}\right) \\
q_{1}=-K_{\mathrm{P}}\left(1+\frac{2 T_{\mathrm{D}}}{T}\right) \\
q_{2}=K_{\mathrm{p}} \frac{T_{\mathrm{D}}}{T}
\end{array}\right.（4-34）
\end{array}
$$

3. 数字 PDD 控制算法实现方式比较

在控制系统中，如果执行机构采用调节阀，则控制量对应蔺门的开度表征了执行机构的位置，此时控制器应采用数字 PID 位置型控制算法，如图 4-4 所示。如执行机构采用步进门动机，每个采样周期控制器输出的控制量，是相对于上次控制量的增加，此时控制器应采用数字 PID 增量型控制算法，如图 4-5 所示。

图 4-4 数字 PID 位置型控制示意图

图4-5 数字 PDD 增量型控制示意图
增量型算法与位置型算法相比，具有以下优点：
1）增量算法不需要做累加，控制量增量的确定仅与最近几次误差采样值有关，计算误差或计算精度问题对控制量的计算影响较小。而位置算法要用到过去的误差的累加值，容易产生大的累加误差。

2）增量型算法得出的是控制量的增量，例如阀门控制中只输出阀门开度的变化部分，误动作影响小，必要时通过逻辑判断限制或禁止本次输出，不会严重影响系统的工作。而位置算法的输出是控制量的全量输出，误动作影响大。

3）采用增量算法，易于实现手动到自动的无冲击切换。
4. 数字 PID 控制算法流程

图 4-6 给出了数字 PID 增量型控制算法的流程图。利用增量型控制算法，也可得出位置型控制算法, 即

$$
u(k)=u(k-1)+\Delta u(k)=u(k-1)+q_{0} e(k)+q_{1} e(k-1)+q_{2} e(k-2)
$$

（4-35）
式（4-35）便是位置型控制算式的递推算法，其程序流程和增量型控制算法类似，对图 4-6稍加修改即可得到数字 PID 位置型控制算法流程图。

图 4-6 数字 PID 增量型控制算法流程图
4.1.3 数字 PID 控制器的改进

如果单纯地用数字 PID 控制器去模仿模拟调节器，不会获得更好的效果。因此必须发挥计算机运算速度快、逻辑判断功能强、编程灵活等优势，才能在控制性能上超过模拟调节器。

1. 积分项的改进

在 PID 控制中，积分的作用是消除残差，为了提高控制性能，对积分项可采取以下 4 条改进措施。
（1）积分分离
在一般的 PID 控制中，当有较大的扰动或大幅度改变给定值时，由于此时有较大的偏差，以及系统有惯性和滞后，故在积分项的作用下，往往会产生较大的超调和长时间的波动。特别对于温度、成分等变化缓慢的过程，这一现象更为严重。为此，可采用积分分离措施，即偏差 $e(k)$ 较大时，取消积分作用；当偏差 $e(k)$ 较小时才将积分作用投人。亦即当 $|e(k)|>\beta$ 时，采用 PD 控制；当 $|e(k)| \leqslant \beta$ 时，采用 PID 控制。
积分分离阈值 $\beta$ 应根据具体对象及控制要求确定。若 $\beta$ 值过大，达不到积分分离的目的；若 $\beta$ 值过小，一旦被控量 $y(t)$ 无法跳出各积分分离区，只进行 PD 控制，将会出现残差，如图 4-7 所示的曲线 $b$ 。为了实现积分分离，编写程序时必须从数字 PID 差分方程式中分离出积分项，进行特殊处理。
（2）抗积分饱和
因长时间出现偏差或偏差较大，计算出的控制量有可能溢出，或小于零。所谓溢出就是计算机运算得出的控制量 $u(k)$ 超出 D-A 转换器所能表示的数值范围。例如， 8 位 D-A 的数据范围为 00 H 至 FFH（H 表示十六进制）。一般执行机构有两个极限位置，如调节阀全开或全关。设 $u(k)$ 为 FFH 时，调节阀全开；反之， $u(k)$ 为 00 H 时，调节间全关。为了提高运算䊑度，通常采用双字节或浮点数计算：

出4.7 积分分蕳自敛

PID 差分方程式。如果执行机构已到极限位置，仍然不能消除偏差时，由于积分作用，尽管计算 PID 差分方程式所得的运分结果继续增大或减小，但执行机构已无相应的动作，这就称为积分饱和。当出现积分饱和时，势必使超调量增加，控制品质变坏。作为防止积分饱和的办法之一，可对计算出的控制量 $u(k)$ 㴆幅，同时，把积分作用切除掉。若以 8 位 D-A 为例，则有

当 $u(k)<00 \mathrm{H}$, 取 $u(k)=0$
当 $u(k)>\mathrm{FFH}$, 取 $u(k)=0 \mathrm{FFH}$
(3) 梯形积分

在 PID 控制器中，积分项的作用是消除残差。为了减少残差，应提高积分项的运算精度。为此, 可将矩形积分改为梯形积分, 其计算公式为

$$
\int_{0}^{t} e(t) \mathrm{d} t \approx \sum_{i=0}^{k} \frac{e(i)+e(i-1)}{2} T
$$

（4-36）
（4）消除积分不灵敏区
由式（4-32）知，数字 PID 的增量型控制算式中的积分项输出为

$$
\Delta u_{1}(k)=K_{\mathrm{l}} e(k)=K_{\mathrm{p}} \frac{T}{T_{\mathrm{I}}} e(k)
$$

（4-37）
由于计算机字长的限制，当运算结果小于字长所能表示的数的精度，计算机就作为 "零"将此数丢掉。从式（4-37）可知，当计算机的运行字长较短，采样周期 $T$ 也短，而积分时间 $T_{1}$ 又较长时, $\Delta u(k)$ 容易出现小于字长的精度而丢数, 此积分作用消失, 这就称为积分不灵敏区。例如，某温度控制系统，温度量程为 $0 \sim 1275^{\circ} \mathrm{C}$ ，D-A 转换为 8 位，并采用 8 位字长定点运算。设 $K_{\mathrm{P}}=1, T=1 \mathrm{~s}, T_{\mathrm{I}}=10 \mathrm{~s}, e(k)=50^{\circ} \mathrm{C}$, 根据式 (4-37) 得

$$
\Delta u_{\mathrm{I}}(k)=K_{\mathrm{P}} \frac{T}{T_{1}} e(k)=\frac{1}{10} \times\left(\frac{255}{1275} \times 50\right)=1
$$

这就说明，如果偏差 $e(k)<50^{\circ} \mathrm{C}$ ，则 $\Delta u(k)<1$ ，计算机就作为 "零" 将此数丢掉，控制器就没有积分作用。只有当偏差达到 $50^{\circ} \mathrm{C}$ 时，才会有积分作用。这样，势必造成控制系统的残差。

为了消除积分不灵敏区，通常采用以下措施：
1）增加 D-A 和 A-D 转换位数，加长运算字长，这样可以提高运算精度。
2）当积分项 $\Delta u(k)$ 连续 $n$ 次出现小于输出精度 $\varepsilon$ 的情况时，不要把它们作为 "零" 舍掉, 而是把它们一次次累加起来, 即

$$
S_{\mathrm{I}}=\sum_{i=1}^{n} \Delta u_{\mathrm{I}}(i)
$$

（4-38）
直到累加值 $S_{1}$ 大于 $\varepsilon$ 时, 才输出 $S_{\mathrm{I}}$, 同时把累加单元清零, 其程序流程如图 4-8 所示。

图4-8 消除积分不灵敏区程序流程
2. 微分项的改进
（1）不完全微分 PID 控制算法
标准的 PID 控制算式，对具有高频扰动的生产过程，微分作用响应过于灵敏，容易引起控制过程振荡，降低调节品质。尤其是计算机对每个控制回路输出时间是短暂的，而驱动执行器动作又需要一定时间, 如果输出较大, 在短暂时间内执行器达不到应有的相应开度, 会使输出失真。为了克服这一缺点，同时又要使微分作用有效，可以在 PID 控制输出串联一阶惯性环节，这就组成了不完全微分 PID 控制

图 4-9 不完全微分 PID 控制器

器, 如图 4-9 所示。

一阶惯性环节 $D_{\mathrm{f}}(s)$ 的传递函数为

$$
D_{\mathrm{f}}(s)=\frac{1}{T_{\mathrm{f}} s+1}
$$

（4-39）
因为

$$
\begin{array}{c}
u^{\prime}(t)=K_{\mathrm{P}}\left[e(t)+\frac{1}{T_{1}} \int_{0}^{t} e(t) \mathrm{d} t+T_{\mathrm{D}} \frac{\mathrm{~d} e(t)}{\mathrm{d} t}\right] \\
T_{\mathrm{f}} \frac{\mathrm{~d} u(t)}{\mathrm{d} t}+u(t)=u^{\prime}(t)
\end{array}
$$

所以

$$
T_{\mathrm{r}} \frac{\mathrm{~d} u(t)}{\mathrm{d} t}+u(t)=K_{\mathrm{P}}\left[e(t)+\frac{1}{T_{\mathrm{I}}} \int_{0}^{t} e(t) \mathrm{d} t+T_{\mathrm{D}} \frac{\mathrm{~d} e(t)}{\mathrm{d} t}\right]
$$

（4-40）
对式（4-40）进行离散化，可得不完全微分 PID 位置型控制算式

$$
u(k)=\alpha u(k-1)+(1-\alpha) u^{\prime}(k)
$$

（4-41）
式中 $u^{\prime}(k)=K_{\mathrm{P}}\left[e(k)+\frac{T}{T_{\mathrm{I}}} \sum_{i=0}^{k} e(i)+T_{\mathrm{D}} \frac{e(k)-e(k-1)}{T}\right]$

$$
\alpha=\frac{T_{\mathrm{f}}}{T_{\mathrm{f}}+T}
$$

与标准 PID 控制算式一样，不完全微分 PD 控制器也有增量型控制算式，即

$$
\Delta u(k)=\alpha \Delta u(k-1)+(1-\alpha) \Delta u^{\prime}(k)
$$

（4-42）
式中

$$
\begin{array}{ll}
\Delta u^{\prime}(k)=K_{\mathrm{P}}[e(k)-e(k-1)]+K_{\mathrm{I}} e(k)+K_{\mathrm{D}}[e(k)-2 e(k-1)+e(k-2)] \\
K_{\mathrm{I}}=K_{\mathrm{p}} T / T_{\mathrm{I}} & \text { 称为积分系数 } \\
K_{\mathrm{D}}=K_{\mathrm{P}} T_{\mathrm{D}} / T & \text { 称为积分系数 }
\end{array}
$$

图4-10a 和 b 分别表示标准 PID 控制算式（4-30）和不完全微分 PID 控制算式（4-41）在单位阶跃输人时输出的控制作用。由图 4-10a 可见，标准 PID 控制算式中的微分作用只在第一个采样周期内起作用，而且作用很强。而不完全微分 PID 控制算式的输出在较长时间内仍有微分作用，因此可获得较好的控制效果。
a）标准PID控制
b）不完全微分PID控制

图 4-10 PID 控制的阶跃响应
（2）微分先行 PID 控制算式
为了避免给定值的升降给控制系统带来冲击，如超调量过大，调节阀动作剧烈，可采用如图4-11所示的微分先行 PID 控制方案。它和标准 PID 控制的不同之处在于，只对被控量 $y(t)$ 微分，不对偏差 $e(t)$微分，也就是说对给定值 $r(t)$ 无微分作用。被控量微分 PID 控制算法称为微分先行 PID 控制算法, 该算法对给定值频繁升降的系统无疑是有效的。图中， $\gamma$ 为微分增益系数。

图 4-11 微分先行 PID 控制方块图
3. 时间最优 PID 控制

最大值原理是庞特里亚金（Pontryagin）于1956年提出的一种最优控制理论，最大值原理也叫快速时间最优控制原理，它是研究满足约束条件下获得允许控制的方法。用最大值原理可以设计出控制变量只在 $u(t) \leqslant 1$ 范围内取值的时间最优控制系统。而在工程上, 设 $u(t) \leqslant 1$ 都只取 $\pm 1$ 两个值, 而且依照一定法则加以切换, 使系统从一个初始状态转到另一个状态所经历的过渡时间最短，这种类型的最优切换系统，称为开关控制（Bang-Bang 控制）系统。

在工业控制应用中，最有发展前途的是 Bang-Bang 控制与反馈控制相结合的系统，这种控制方式在给定值升降时特别有效，具体形式为

$$
|e(k)|=|r(k)-y(k)|\left\{\begin{array}{l}
>\alpha, \text { Bang-Bang 控制 } \\
\leqslant \alpha, \text { PID 控制 }
\end{array}\right.
$$

时间最优位置随动系统，从理论上讲应采用 Bang-Bang 控制。但 Bang-Bang 控制很难保证足够高的定位精度，因此对于高精度的快速伺服系统，宜采用 Bang-Bang 控制和线性控制相结合的方式，在定位线性控制段采用数字 PID 控制就是可选的方案之一。
4. 带死区的 PID 控制算法

在计算机控制系统中，某些系统为了避免控制动作过于频繁，以消除由于频繁动作所引起的振荡，有时采用所谓带有死区的 PID 控制系统，如图 4-12 所示，相应的算式为

$$
P(k)=\left\{\begin{array}{ll}
e(k), & \text { 当 }|r(k)-y(k)|=|e(k)|>\varepsilon \\
0, & \text { 当 }|r(k)-y(k)|=|e(k)| \leqslant \varepsilon
\end{array}\right.
$$

在图 4-12 中，死区 $\varepsilon$ 是一个可调参数，其具体数值可根据实际控制对象由实验确定。 $\varepsilon$值太小，使调节过于频繁，达不到稳定被调节对象的目的；如果 $\varepsilon$ 取得太大，则系统将产生很大的滞后；当 $\varepsilon=0$ ，即为常规 PID 控制。

图 4-12 带死区的 PID 控制系统框图

该系统实际上是一个非线性控制系统。即当偏差绝对值 $|e(k)| \leqslant \varepsilon$ 时, $p(k)$ 为 0 ; 当 $|e(k)|>\varepsilon$ 时, $p(k)=e(k)$ ，输出值 $u(k)$ 以 PID 运算结果输出。
4.1.4 数字 PID 控制器的参数整定

1. 采样周期的选择
（1）首先要考虑的因素
香农采样定理给出了采样周期的上限。根据采样定理，采样周期应满足

$$
T \leqslant \pi / \omega_{\max }
$$

式中， $\omega_{\max }$ 为被采样信号的上限角频率。
采样周期的下限为计算机执行控制程序和输人输出所耗费的时间，系统的采样周期只能在 $T_{\text {min }}$ 与 $T_{\text {max }}$ 之间选择。采样周期 $T$ 既不能太大也不能太小， $T$ 太小时，一方面增加了微型计算机的负担，不利于发挥计算机的功能；另一方面，两次采样间的偏差变化太小，数字控制器的输出值变化不大。因此，采样周期 $T$ 应在 $T_{\text {min }}$ 和 $T_{\text {max }}$ 之间，即

$$
T_{\min } \leqslant T \leqslant T_{\max }
$$

若选择采样周期在 $T$ 与 $T_{max}$ 之间, 则系统可以稳定工作, 但控制质量较差。若采样周期选择在 $T_{min}$ 与 $T$ 之间，满足采样定理，可得到较好的控制质量。
（2）其次要考否以下各方面的因素
1）给定值的变化频率：加到被控对象上的给定值变化频率越高，采样频率应越高。这样给定值的改变可以迅速得到反映。

2）被控对象的特性：若被控对象是慢速的热工或化工对象时，采样周期一般取得较大；若被控对象是较快速的系统时，采样周期应取得较小。

3）执行机构的类型：执行机构动作惯性大，采样周期也应大一些，否则执行机构来不及反映数字控制器输出值的变化。

4）控制算法的类型：当采用 PID 算式时，积分作用和积分作用与采样周期 $T$ 的道报有关。选择采样周期 $T$ 太小，将使微分积分作用不朋显。因为当 $T$ 小到一定程度后，由于受计算槏应的限制，偏差 $e(k)$ 始终为零。另外，各种控制等法也需要计算时间。

5）控例的回路数：控制的回路数 $n$ 与采样周期 $T$ 有下列关系

$$
T \geqslant \sum_{j=1}^{\mathrm{n}} T_{j}
$$

式中， $T_{j}$ 为第 $j$ 回路控制程序执行时问和输入输出时问。
2. 按简易工程法整定 PID 参数

在连续控制系统中，模拟调节器的参数整定方法较多，但间单易行的方法还是第 8 工程法。这种方法最大的优点在于，整定参数时不必依㹲被控对象的数学模型。一般情况下，难但是简单易行，适于现场应用。
（1）扩充临界比例度法
扩充临界比例度法是对模拟调节器中使用的临界比例度法的扩充。下面徐述用来整定数字控制器参数的步骤。

1）选择一个足够短的采样周期，具体地说就是选择采样周期为被控对象纯滞后时问的十分之一以下。

2）用选定的采样周期使系统工作。这时，数字控制器去掉积分作用和微分作用，只保留比例作用。然后逐渐减小比例度 $\delta\left(\delta=1 / K_{\mathrm{p}}\right)$ ，直到系统发生持续等幅振荡。记下使系统发生振荡的临界比例度 $\delta_{k}$ 及系统的临界振荡周期 $T_{k}$ 。

3）选择控制度。所谓控制度就是以模拟调节器为基准，将 DDC 的控制效果与模拟调节器的控制效果相比较。控制效果的评价函数通常用误差二次方积分 $\int_{0}^{2} e^{2}(t) \mathrm{d} t$ 表示。

$$
\text { 控制度 }=\frac{\left[\int_{0}^{\infty} e^{2}(t) \mathrm{d} t\right]_{D D C}}{\left[\int_{0}^{z} e^{2}(t) \mathrm{d} t\right]_{模拟}}
$$

实际应用中并不需要计算出两个误差二次方积分，控制度仅表示控制效果的物理概念。例如，当控制度为 1.05 时，就是指 DDC 与模拟控制效果相当；控制度为 2.0 时，是指 DDC比模拟控制效果差。

4）根据选定的控制度，查表4-1，求得 $T 、 K_{\mathrm{P}} 、 T_{I} 、 T_{\mathrm{D}}$ 的值。

表4-1 按扩充临界比例度法整定参数


| 控 制 度 | 控制规律 | T | $K_{p}$ | $T_{I}$ | $T_{D}$ |
| :-- | :-- | :-- | :-- | :-- | :-- |
| 1.05 | PI | $0.03 T_{k}$ | $0.53 \delta_{k}$ | $0.88 T_{k}$ |  |
| 1.05 | PID | $0.014 T_{k}$ | $0.63 \delta_{k}$ | $0.49 T_{k}$ | $0.14 T_{k}$ |
| 1.2 | PI | $0.05 T_{k}$ | $0.49 \delta_{k}$ | $0.91 T_{k}$ |  |
| 1.2 | PID | $0.043 T_{k}$ | $0.47 \delta_{k}$ | $0.47 T_{k}$ | $0.16 T_{k}$ |
| 1.5 | PI | $0.14 T_{k}$ | $0.42 \delta_{k}$ | $0.99 T_{k}$ |  |
| 1.5 | PID | $0.09 T_{k}$ | $0.34 \delta_{k}$ | $0.43 T_{k}$ | $0.20 T_{k}$ |
| 2.0 | PI | $0.22 T_{k}$ | $0.36 \delta_{k}$ | $1.05 T_{k}$ |  |
| 2.0 | PID | $0.16 T_{k}$ | $0.27 \delta_{k}$ | $0.40 T_{k}$ | $0.22 T_{k}$ |

（2）扩充响应曲线法
在模拟控制系统中，可用响应曲线法代替临界比例度法一样，在 DDC 中也可以用扩充响应曲线法代替扩充临界比例度法。用扩充响应曲线法整定 $T$ 和 $K_{\mathrm{P}} 、 T_{I} 、 T_{\mathrm{D}}$ 的步骤如下。

1）数字控制器不接入控制系统，让系统处于手动操作状态下, 将被调量调节到给定值附近，并使之稳定下来。然后突然改变给定值，给对象一个阶跃输入信号。

2）用记录仪表记录被调量在阶跃输入下的

图 4-13 被调量在阶跃输入下的变化过程曲线

整个变化过程曲线，如图4-13 所示。

3）在曲线最大斜率处作切线，求得滞后时间 $\tau$ ，被控对象时间常数 $T_{\tau}$ 以及它们的比值 $T_{\tau} / T$, 查表 4-2, 即可得数字控制器的 $K_{\mathrm{P}} 、 T_{I} 、 T_{\mathrm{D}}$ 及采样周期 $T_{\text {。 }}$

表4-2 按扩充响应曲线


| 控 制 度 | 控制规律 | T | $K_{p}$ | $T_{I}$ | $T_{D}$ |
| :-- | :-- | :-- | :-- | :-- | :-- |
| 1.05 | PI | $0.1 \tau$ | $0.84 T_{\tau} / \tau$ | $0.34 \tau$ |  |
| 1.05 | PID | $0.05 \tau$ | $1.15 T_{\tau} / \tau$ | $2.0 \tau$ | $0.45 \tau$ |
| 1.2 | PI | $0.2 \tau$ | $0.78 T_{\tau} / \tau$ | $3.6 \tau$ |  |
| 1.2 | PID | $0.16 \tau$ | $1.0 T_{\tau} / \tau$ | $1.9 \tau$ | $0.55 \tau$ |
| 1.5 | PI | $0.5 \tau$ | $0.68 T_{\tau} / \tau$ | $3.9 \tau$ |  |
| 1.5 | PID | $0.34 \tau$ | $0.85 T_{\tau} / \tau$ | $1.62 \tau$ | $0.65 \tau$ |
| 2.0 | PI | $0.8 \tau$ | $0.57 T_{\tau} / \tau$ | $4.2 \tau$ |  |
| 2.0 | PID | $0.6 \tau$ | $0.6 T_{\tau} / \tau$ | $1.5 \tau$ | $0.82 \tau$ |

（3）归一参数整定法
除了上面讲的一般的扩充临界比例度法外，Roberts P. D 在 1974 年提出一种简化扩充临界比例度整定法。由于该方法只需整定一个参数即可, 故称其归一参数整定法。已知增量型 PID 控制的公式为
$\Delta u(k)=K_{\mathrm{P}}\left\{e(k)-e(k-1)+\frac{T}{T_{\mathrm{I}}} e(k)+\frac{T_{\mathrm{D}}}{T}[e(k)-2 e(k-1)+e(k-2)]\right\}$

如令 $T=0.1 T_{k} ; T_{I}=0.5 T_{k} ; T_{\mathrm{D}}=0.125 T_{k}$ 。式中 $T_{k}$ 为纯比例作用下的临界振荡周期。则

$$
\Delta u(k)=K_{\mathrm{P}}[2.45 e(k)-3.5 e(k-1)+1.25 e(k-2)]
$$

这样，整个问题便简化为只要整定一个参数 $K_{\mathrm{P}}$ 。改变 $K_{\mathrm{P}}$ ，观察控制效果，直到满意为止。该法为实现简易的自整定控制带来方便。
3. 优选法

由于实际生产过程错综复杂，参数千变万化，因此，如果确定被调对象的动态特性并非容易之事。有时即使能找出来, 不仅计算麻烦, 工作量大, 而且其结果与实际相差较远。因此，目前应用最多的还是经验法。即根据具体的调节规律，不同调节对象的特征、经过闭环试验，反复凑试，找出最佳调节参数。这里向大家介绍的也是经验法的一种，即用优选法对自动调节参数进行整定的方法。

其具体做法是根据经验，先把其他参数固定，然后用 0.618 法对其中某一参数进行优选，待选出最佳参数后，再换另一个参数进行优选，直到把所有的参数优选完毕为止。最后根据 $T 、 K_{\mathrm{P}} 、 T_{I} 、 T_{\mathrm{D}}$ 诸参数优选的结果，取一组最佳值即可。
4. 凑试法确定 PID 参数

增大比例系数 $K_{\mathrm{p}}$ 一般将加快系统的响应，有利于减小静差。但过大的比例系数会使系统有较大的超调，并产生振荡，使稳定性变坏。增大积分时间 $T_{1}$ 有利于跛小题调，减小振荡，使系统更加稳定，但系统静差的消除将随之减慢。增大噋分时问 $T_{0}$ 亦有利于加快系统响应，便超调量减小，稳定性增加，但系统对扰动的抑制能力减弱。对扰动有较敏感的响应。

凑试时，可参考以上参数对控制过程的影响趋势，对参数实行先比例、再积分、后微分的整定步骤。

1）首先只整定比例部分。将比例系数由小变大，并观察相应的系统响应，直到得到反应快、超调小的响应曲线。如果系统没有静差或静差已小到允许范围内，并且响应曲线已属满意，那么只需用比例调节器即可，最优比例系数可由此确定。

2）在比例调节的基础上，若系统的静差不能满足设计要求，则须加入积分环节。整定时首先置积分时间 $T_{1}$ 为一较大值，并将经第一步整定得到的比例系数略为缩小（如缩小为原值的 0.8 倍），然后减小积分时间，使在保持系统良好动态性能的情况下，静差得到消除。在此过程中, 可根据响应曲线的好坏反复改变比例系数与积分时间, 以期得到满意的控制过程与整定参数。

3）若使用比例积分调节器消除了静差，但动态过程经反复调整仍不能满意，则可加人微分环节, 构成比例积分微分调节器。在整定时, 可先置微分时间 $T_{\mathrm{D}}$ 为零。在第二步整定的基础上, 增大 $T_{\mathrm{D}}$, 同时相应地改变比例系数和积分时间, 逐步凑试, 以获得满意的调节效果和控制参数。
5. PID 控制参数的自整定法

被控对象大多用近似一阶惯性加纯滞后环节来表示，其传递函数为 $G_{c}(s)=\frac{K e^{-\tau s}}{1+T s}$ ，对于典型 PID 控制器 $G_{\mathrm{c}}(s)=K_{\mathrm{P}}\left(1+\frac{1}{T_{I} s}+T_{\mathrm{D}} s\right)$, 有齐格勒-尼科尔斯（Ziegler-Nichols）整定公式

$$
\left\{\begin{array}{l}
K_{P}=1.2 T / K_{\tau} \\
T_{I}=2 \tau \\
T_{D}=0.5 \tau
\end{array}\right.
$$

（4-43）
实际应用时，通常根据阶跃响应曲线，人工测量出 $K, T, \tau$ 参数，然后按式（4-43）计算 $K_{\mathrm{P}} 、 T_{1} 、 T_{\mathrm{D}}$ 。用计算机进行辅助设计时，一是可以用模式辨识的方法辨识出这些特征参数；二是可用曲线拟合的方法将阶跃响应数据拟合成近似的一阶惯性加纯滞后环节的模型。

参数自整定就是在被控对象特性发生变化后，立即使 PID 控制参数随之作相应的调整，使得 PID 控制器具有一定的"自调整"或"自适应"能力。在此引入特征参数法，来描述 PID 参数的自整定技术。

所谓特征参数法就是抽取被控对象的某些特征参数，以其为依据自动整定 PID 控制参数。基于被控对象参数的 PID 控制参数自整定法的首要工作是，在线辨识被控对象某些特征参数，比如临界增益 $K$ 和临界周期 $T$ （频率 $\omega=2 \pi / T$ ）。这种在线辨识特征参数占用计算机较少的软硬件资料，在工业中应用比较方便。典型的有上面介绍的齐格勒-尼科尔斯（Zie-gler-Nichols）研究出的临界振荡法，在此基础上 K. J. Åsröm 又进行了改进，采用具有滞环的继电器非线性反馈控制系统，如图 4-14 所示。其中继电器型非线性特性的幅值为 $d$ ，滞环宽度为 $h$, 继电器输出为周期性的对称方波。

图4-14 具有滞环的继电器非线性反馈控制系统
首先通过人工控制使系统进人稳定工况，然后将整定开关 S 接通 T ，获得极限环，使被控量 $y$ 出现临界等幅振荡。其振荡幅度为 $a$, 振荡周期即为临界周期 $T_{k}$, 临界增益为 $K=$ $4 d / \pi a$ 。一旦获得 $T_{k}$ 和 $\delta_{k}\left(\delta_{k}=1 / K\right)$, 再根据表 4-1 即可求得 PID 控制器的整定参数。最后,将整定开关 S 接通 A ，使 PID 控制器投入正常运行。

该方法简单、概念清楚。但是，有时因噪声干扰会对被控量 $y$ 的采样值带来误差，从而影响 $T$ 和 $K$ 的精度，使之因为系统干扰太大，不存在稳定的极限环。
4.2 数字控制器的离散化设计技术

数字控制器的连续化设计技术, 是立足于连续控制系统控制器的设计, 然后在计算机上进行数字模拟来实现的，这种方法在被控对象的特性不太清楚的情况下，人们可以充分利用技术成熟的连续化设计技术 (如 PID 控制器的设计技术), 并把它移植到计算机上予以实现, 以达到满意的控制效果。但是连续化设计技术要求相当短的采样周期, 因此只能实现较简单的控制算法。由于控制任务的需要，当所选择的采样周期比较大或对控制质是要求比软离时，必须从被控对象的特性出发，直接根据计算机控制理论（采样控制理论）来设计数字控制器，这类方法称为离散化设计方法。离散化设计技术比连续化设计技术更具有一般意义，它完全是根据采样控制系统的特点进行分析和综合，并导出相应的控制规律和算法。
42.1 数字控制器的离散化设计步骤

在图 4-15 所示的计算机控制系统框图中， $G_{\mathrm{c}}(s)$ 是被控对象的连续传递函数， $D(z)$ 是数字控制器的脉冲传递函数， $H(s)$ 是零阶保持器的传递函数， $T$ 为采样周期。

图 4-15 计算机控制系统框图
在图中, 定义广义对象的脉冲传递函数为

$$
G(z)=\frac{B(z)}{A(z)}=Z\left[H(s) G_{\mathrm{c}}(s)\right]=Z\left[\frac{1-\mathrm{e}^{-T_{\mathrm{s}}}}{S} G_{\mathrm{c}}(s)\right]
$$

（4-44）
可得图 4-15 对应的闭环脉冲传递函数为

$$
\Phi(z)=\frac{D(z) G(z)}{1+D(z) G(z)}
$$

（4-45）
由式（4-45） 可求得

$$
D(z)=\frac{1}{G(z)} \frac{\Phi(z)}{1-\Phi(z)}
$$

设数字控制器 $D(z)$ 的一般形式为

$$
D(z)=\frac{U(z)}{E(z)}=\frac{\sum_{i=0}^{m} b_{i} z^{-i}}{1+\sum_{i=1}^{n} a_{i} z^{-i}}, \quad(n \geqslant m)
$$

（4-47）
数字控制器的输出 $U(z)$ 为

$$
U(z)=\sum_{i=0}^{m} b_{i} z^{-i} E(z)-\sum_{i=1}^{n} a_{i} z^{-i} U(z)
$$

（4-48）
因此, 数字控制器 $D(z)$ 的计算机控制算法为

$$
u(k)=\sum_{i=0}^{m} b_{i} e(k-i)-\sum_{i=1}^{n} a_{i} u(k-i)
$$

（4-49）
按照式（4-49），就可编写出控制算法程序。
若已知 $G_{\mathrm{c}}(s)$ 且可根据控制系统性能指标要求构造 $\Phi(z)$, 则可由式（4-44）和式（4-46）求得 $D(z)$ 。由此可得出数字控制器的离散化设计步骤如下：

1）根据控制系统的性能指标要求和其他约束条件，确定所需的闭环脉冲传递函数 $\Phi(z)$ 。
2）根据式（4-44）求广义对象的脉冲传递函数 $G(z)$ 。
3）根据式（4-46）求取数字控制器的脉冲传递函数 $D(z)$ 。
4）根据式（4-47）求取控制量 $u(k)$ 的递推计算公式（4-49）。

2.2 最少拍控制器的设计

在数字随动控制系统中, 要求系统的输出值快速地跟踪给定值的变化, 最少拍控制就是为满足这一要求的一种离散化设计方法。所谓最少拍控制，就是要求闭环系统对于某种特定的输入在最少几个采样周期内达到无静差的稳态，且闭环脉冲传递函数具有以下形式

$$
\Phi(z)=\phi_{1} z^{-1}+\phi_{2} z^{-2}+\cdots+\phi_{N} z^{-N}
$$

（4-50）
式中， $N$ 是可能情况下的最小正整数。
这一形式表明闭环系统的脉冲响应在 $N$ 个采样周期后变为零, 从而意味着系统在 $N$ 拍之内达到稳态。

1. 闭环脉冲传递函数 $\Phi(z)$ 的确定

由图4-15 可知, 误差 $E(z)$ 的脉冲传递函数为

$$
\Phi_{\mathrm{e}}(z)=\frac{E(z)}{R(z)}=\frac{R(z)-Y(z)}{R(z)}=1-\Phi(z)
$$

（4-51）
式中, $E(z)$ 为误差信号 $e(t)$ 的 $Z$ 变换; $R(z)$ 为输人函数 $r(t)$ 的 $Z$ 变换; $Y(z)$ 为输出量 $y(t)$的 $Z$ 变换。

于是误差 $E(z)$ 为

$$
E(z)=R(z) \Phi_{\mathrm{e}}(z)
$$

（4-52）
对于典型输人函数

$$
r(t)=\frac{1}{(q-1)!} t^{q-1}
$$

（4-53）
对应的 $Z$ 变换为

$$
R(z)=\frac{B(z)}{\left(1-z^{-1}\right)^{q}}
$$

（4-54）
式中, $B(z)$ 为不包含 $\left(1-z^{-1}\right)$ 因子的关于 $z^{-1}$ 的多项式, 当 $q$ 分别等于 $1 、 2 、 3$ 时, 对应的典型输入为单位阶跃、单位速度、单位加速度输入函数。

根据 $Z$ 变换的终值定理，系统的稳态误差为

$$
\begin{aligned}
e(\infty) & =\lim _{z \rightarrow 1}\left(1-z^{-1}\right) E(z)=\lim _{z \rightarrow 1}\left(1-z^{-1}\right) R(z) \Phi_{\mathrm{e}}(z) \\
& =\lim _{z \rightarrow 1}\left(1-z^{-1}\right) \frac{B(z)}{\left(1-z^{-1}\right)^{q}} \Phi_{\mathrm{e}}(z)
\end{aligned}
$$

（4-55）
由于 $B(z)$ 没有 $\left(1-z^{-1}\right)$ 因子, 因此要使稳态误差 $e(\infty)$ 为零, 必须有

$$
\Phi_{e}(z)=1-\Phi(z)=\left(1-z^{-1}\right)^{q} F(z)
$$

（4-56）
即有

$$
\Phi(z)=1-\Phi_{e}(z)=1-\left(1-z^{-1}\right)^{q} F(z)
$$

（4-57）
这里 $F(z)$ 是关于 $z^{-1}$ 的待定系数多项式。显然, 为了使 $\Phi(z)$ 能够实现, $F(z)$ 中的首项应取为 1 , 即

$$
F(z)=1+f_{1} z^{-1}+f_{2} z^{-2}+\cdots+f_{p} z^{-p}
$$

（4-58）
可以看出, $\Phi(z)$ 具有 $z^{-1}$ 的最高幂次为 $N=p+q$, 这表明系统闭环响应在采样点的值经 $N$ 拍可达到稳态。特别当 $p=0$, 即 $F(z)=1$ 时, 系统在采样点的输出可在最少拍 ( $N_{\text {min }}=q$ 拍)内达到稳态，即为最少拍控制。因此最少拍控制器设计时选择 $\Phi_{\mathrm{o}}(z)$ 为

$$
\begin{array}{c}
\Phi_{\mathrm{e}}(z)=\left(1-z^{-1}\right)^{q} （4-59）\\
\Phi(z)=1-\Phi_{\mathrm{e}}(z)=1-\left(1-z^{-1}\right)^{q} （4-60）
\end{array}
$$

由式 (4-46) 可知, 最少拍控制器 $D(z)$ 为

$$
D(z)=\frac{1}{G(z)} \frac{\Phi(z)}{1-\Phi(z)}=\frac{1-\left(1-z^{-1}\right)^{q}}{G(z)\left(1-z^{-1}\right)^{q}}
$$

（4-61）
2. 典型输入下的最少拍控制系统分析
(1) 单位阶跃输入（ $a=1$ ）

输人函数 $r(t)=1(t)$ ，其 $Z$ 变换为

$$
\begin{array}{c}
R(z)=\frac{1}{1-z^{-1}} \\
\Phi(z)=1-\left(1-z^{-1}\right)^{q}=z^{-1}
\end{array}
$$

由式（4-60）可知
因而有

$$
\begin{aligned}
E(z) & =R(z) \Phi_{e}(z)=R(z)[1-\Phi(z)]=\frac{1}{1-z^{-1}}\left(1-z^{-1}\right)=1 \\
& =1 \cdot z^{0}+0 \cdot z^{-1}+0 \cdot z^{-2}+\cdots
\end{aligned}
$$

进一步求得

$$
Y(z)=R(z) \Phi(z)=\frac{1}{1-z^{-1}} z^{-1}=z^{-1}+z^{-2}+z^{-3}+\cdots
$$

以上两式说明, 只需一抽（一个采样周期）输出就能跟踪输入，误差为零，过渡过程结束。
(2) 单位速度输人（ $q=2$ ）

输入函数 $r(t)=t$ 的 $Z$ 变换为

$$
R(z)=\frac{T z^{-1}}{\left(1-z^{-1}\right)^{2}}
$$

由式 (4-60) 知, 有 $\Phi(z)=1-\left(1-z^{-1}\right)^{2}=2 z^{-1}-z^{-2}$
且有

$$
\begin{array}{l}
E(z)=R(z) \Phi_{\mathrm{e}}(z)=R(z)[1-\Phi(z)]=\frac{T z^{-1}}{\left(1-z^{-1}\right)^{2}}\left(1-2 z^{-1}+z^{-2}\right)=T z \\
Y(z)=R(z) \Phi(z)=2 T z^{-2}+3 T z^{-3}+4 T z^{-4}+\cdots
\end{array}
$$

以上两式说明、只需二拍（两个采样周期）输出就能跟踪输人，达到稳态。
（3）单位加速度输入（ $q=3)$
单位加速度输入 $r(t)=\frac{1}{2} t^{2}$ 的 $Z$ 变换为

$$
R(z)=\frac{T^{2} z^{-1}\left(1+z^{-1}\right)}{2\left(1-z^{-1}\right)^{3}}
$$

根据式 (4-60), 有

$$
\Phi(z)=1-\left(1-z^{-1}\right)^{3}=3 z^{-1}-3 z^{-2}+z^{-3}
$$

同理

$$
E(z)=\frac{1}{2} T^{2} z^{-1}+\frac{1}{2} T^{2} z^{-2}
$$

上试说明, 只需三拍 (三个采样周期) 输出就能跟踪输人, 达到稳态。

3. 最少拍控制器的局限性
（1）最少拍控制器对典型输入的适应性差
最少拍控制器的设计是使系统对某一典型输人的响应为最少拍，但对于其他典型输人不一定为最少拍，甚至会引起大的超调和静差。例如，当 $\Phi(z)$ 是按等速输入设计时有

$$
\Phi(z)=1-\left(1-z^{-1}\right)^{2}=2 z^{-1}-z^{-2}
$$

3 种不同输人时对应的输出如下:
阶跃输人时

$$
\begin{array}{l}
r(t)=1(t), R(z)=1 /\left(1-z^{-1}\right) \\
Y(z)=R(z) \Phi(z)=\frac{2 z^{-1}-z^{-2}}{1-z^{-1}}=2 z^{-1}+z^{-2}+z^{-3}+\cdots
\end{array}
$$

等速输入时

$$
\begin{array}{l}
r(t)=t, R(z)=\frac{T z^{-1}}{\left(1-z^{-1}\right)^{2}} \\
Y(z)=\frac{T z^{-1}}{\left(1-z^{-1}\right)^{2}}\left(2 z^{-1}-z^{-2}\right)=2 T z^{-2}+3 T z^{-3}+4 T z^{-4}+\cdots
\end{array}
$$

等加速输人时

$$
\begin{aligned}
r(t) & =\frac{1}{2} t^{2}, R(z)=\frac{T^{2} z^{-1}\left(1+z^{-1}\right)}{2\left(1-z^{-1}\right)^{3}} \\
Y(z) & =R(z) \Phi(z)=\frac{T^{2} z^{-1}\left(1+z^{-1}\right)}{2\left(1-z^{-1}\right)^{3}}\left(2 z^{-1}-z^{-2}\right) \\
& =T^{2} z^{-2}+3.5 T^{2} z^{-3}+7 T^{2} z^{-4}+11.5 T^{2} z^{-5}+\cdots
\end{aligned}
$$

对于上述 3 种情况，进行 $z$ 反变换后得到输出序列，如图 4-16 所示。从图中可见，阶跃输人时超调严重（达 $100 \%$ ），加速输人时有静差。
a) 阶跃输人
b）等速输入
c) 等加速度输人

图 4-16 按等速输入设计的最少拍控制器对不同输入的响应
一般来说，针对一种典型的输人函数 $R(z)$ 设计得到系统的闭环脉冲传递函数 $\Phi(z)$ ，用于次数较低的输入函数 $R(z)$ 时，系统将出现较大的超调，响应时间也会增加，但稳态时在采样时刻的误差为零。反之，当一种典型的最少拍特性用于次数较高的输入函数时，输出将不能完全跟踪输人以致产生稳态误差。由此可见，一种典型的最少拍闭环脉冲传递函数 $\Phi$ $(z)$ 只适应一种特定的输人而不能适应于各种输人。
(2) 最少拍控制器的可实现性问题

设图 4-15 和式（4-44）所示的广义对象的脉冲传递函数为

$$
G(z)=\frac{B(z)}{A(z)}
$$

（4-62）
若用 $\operatorname{deg} A(z)$ 和 $\operatorname{deg} B(z)$ 分别表示 $A(z)$ 和 $B(z)$ 的阶数, 显然有

$$
\operatorname{deg} A(z)>\operatorname{deg} B(z)
$$

（4-63）
设数字控制器 $D(z)$ 为

$$
D(z)=\frac{Q(z)}{P(z)}
$$

（4-64）
要使 $D(z)$ 物理上是可实现的, 则必须要求

$$
\operatorname{deg} P(z) \geqslant \operatorname{deg} Q(z)
$$

（4-65）
式（4-65） 的含义是：要产生 $k$ 时刻的控制量 $u(k)$ ，最多只能利用直到 $k$ 时刻的误差 $e(k)$ 、 $e(k-1) 、 \cdots$ 以及过去时刻的控制量 $u(k-1) 、 u(k-2) 、 \cdots$ 。

闭环系统的脉冲传递函数为

$$
\Phi(z)=\frac{D(z) G(z)}{1+D(z) G(z)}=\frac{B(z) Q(z)}{A(z) P(z)+B(z) Q(z)}=\frac{B_{\mathrm{m}}(z)}{A_{\mathrm{m}}(z)}
$$

（4-66）
由式（4-66）可得

$$
\begin{aligned}
\operatorname{deg} A_{\mathrm{m}}(z)-\operatorname{deg} B_{\mathrm{m}}(z) & =\operatorname{deg}[A(z) P(z)+B(z) Q(z)]-\operatorname{deg}[B(z) Q(z)] \\
& =\operatorname{deg}[A(z) P(z)]-\operatorname{deg}[B(z) Q(z)] \\
& =\operatorname{deg} A(z)-\operatorname{deg} B(z)+\operatorname{deg} P(z)-\operatorname{deg} Q(z)
\end{aligned}
$$

所以

$$
\operatorname{deg} A_{\mathrm{m}}(z)-\operatorname{deg} B_{\mathrm{m}}(z) \geqslant \operatorname{deg} A(z)-\operatorname{deg} B(z)
$$

（4-67）
式（4-67） 给出了为使 $D(z)$ 物理上可实现时 $\Phi(z)$ 应满足的条件, 该条件的物理意义是：若 $G(z)$ 的分母比分子高 $N$ 阶, 则确定 $\Phi(z)$ 时必须至少分母比分子高 $N$ 阶。

设给定连续被控对象有 $d$ 个采样周期的纯滞后，相应于图 4-15 的广义对象脉冲传递函数为

$$
G(z)=\frac{B(z)}{A(z)} z^{-d}
$$

（4-68）
则所设计的闭环脉冲传递函数 $\Phi(z)$ 中必须含有纯滞后, 且滞后时间至少要等于被控对象的滞后时间。否则系统的响应超前于被控对象的输人，这实际上是实现不了的。
（3）最少拍控制的稳定性问题
在前面讨论的设计过程中, 对 $G(z)$ 并没有提出限制条件。实际上, 只有当 $G(z)$ 是稳定的（即在 $z$ 平面单位圆上和圆外没有极点），且不含有纯滞后环节时，式（4-59）才成立。如果 $G(z)$ 不满足稳定条件，则需对设计原则作相应的限制。

由式

$$
\Phi(z)=\frac{D(z) G(z)}{1+D(z) G(z)}
$$

（4-69）
可以看出， $D(z)$ 和 $G(z)$ 总是成对出现的，但却不允许它们的零点、极点互相对消。这是因为, 简单地利用 $D(z)$ 的零点去对消 $G(z)$ 中的不稳定极点, 虽然从理论上可以得到一个稳定的闭环系统，但是这种稳定是建立在零极点完全对消的基础上的。当系统的参数产生漂移, 或辨识的参数有误差时, 这种零极点对消不可能准确实现, 从而将引起闭环系统不稳定。上述分析说明, 在单位圆外或圆上 $D(z)$ 和 $G(z)$ 不能对消零极点, 但并不意味含有这种现象的系统不能补偿成稳定的系统，只是在选择 $\Phi(z)$ 时必须加一个约束条件，这个约束条件称为稳定性条件。
4.2.3 最少拍有纹波控制器的设计

在图 4-15 所示的系统中, 被控对象的传递函数为

$$
G_{\mathrm{c}}(s)=G_{\mathrm{c}}^{\prime}(s) \mathrm{e}^{-\tau s}
$$

（4-70）
式中, $G_{\mathrm{c}}^{\prime}(s)$ 是不含滞后部分的传递函数; $\tau$ 为纯滞后时间。
若令

$$
d=\tau / T
$$

（4-71）
则有

$$
\begin{aligned}
G(z) & =Z\left[\frac{1-\mathrm{e}^{-T s}}{s} G_{\mathrm{c}}(s)\right]=Z\left[\frac{1-\mathrm{e}^{-T s}}{s} G_{\mathrm{c}}^{\prime}(s) \mathrm{e}^{-\tau s}\right] \\
& =z^{-d} Z\left[\frac{1-\mathrm{e}^{-T_{s}}}{s} G_{\mathrm{c}}^{\prime}(s)\right]=z^{-d} \frac{B(z)}{A(z)}
\end{aligned}
$$

（4-72）
这里，当连续被控对象 $G_{\mathrm{c}}(s)$ 中不含纯滞后时， $d=0$ ；当 $G(s)$ 中含有纯滞后时， $d \geqslant 1$ ，即有 $d$ 个采样周期的纯滞后。

设 $A(z)$ 的阶次为 $m, B(z)$ 的阶次为 $n, m>n$, 于是, 式 (4-72) 可改写为

$$
G(z)=z^{-d} \frac{B(z)}{A(z)}=z^{-d} \frac{z^{-(m-n)}\left(c_{0}+c_{1} z^{-1}+\cdots+c_{n} z^{-n}\right)}{d_{0}+d_{1} z^{-1}+\cdots+d_{m} z^{-m}}
$$

（4-73）
设 $G(z)$ 有 $u$ 个零点 $b_{1}, b_{2}, \cdots, b_{u}$ 和 $v$ 个极点 $a_{1}, a_{2}, \cdots, a_{v}$ 在 $z$ 平面的单位圆上或圆外, $G^{\prime}(z)$ 是 $G(z)$ 中不含单位圆上或圆外的零极点部分，则广义对象的传递函数可表示为

$$
G(z)=\frac{z^{-(d+m-n)} \prod_{i=1}^{u}\left(1-b_{i} z^{-1}\right)}{\prod_{i=1}^{v}\left(1-a_{i} z^{-1}\right)} G^{\prime}(z)
$$

（4-74）
由式（4-46）可以看出，为了避免使 $G(z)$ 在单位圆外或圆上的零点、极点与 $D(z)$ 的极点、零点对消，同时又能实现对系统的补偿，选择系统的闭环脉冲传递函数时必须满足下面的约束条件。

1. $\Phi_{\mathrm{e}}(z)$ 零点的选择
$\Phi_{\mathrm{e}}(z)$ 的零点中, 必须包含 $G(z)$ 在 $z$ 平面单位圆外或圆上的所有极点, 即

$$
\Phi_{\mathrm{e}}(z)=1-\Phi(z)=\left[\prod_{i=1}^{v}\left(1-a_{i} z^{-1}\right)\right]\left(1-z^{-1}\right)^{q} \Psi(z)
$$

（4-75）
式中, $\Psi(z)$ 是关于 $z^{-1}$ 的待定多项式，且不含 $G(z)$ 中的不稳定极点 $a_{i}$ 。
为了使 $\Phi_{\mathrm{e}}(z)$ 能够实现， $\Psi(z)$ 应具有以下形式

$$
\Psi(z)=1+\psi_{1} z^{-1}+\psi_{2} z^{-2}+\cdots+\psi_{k} z^{-k}
$$

（4-76）
式中， $\psi_{1} 、 \psi_{2} 、 \cdots 、 \psi_{k}$ 为待定系数。
实际上, 若 $G(z)$ 有 $j$ 个极点在单位圆上, 即在 $z=1$ 处, 则由式（4-55）和式（4-56）可知, $\Phi_{\mathrm{e}}(z)$ 的选择方法应对式（4-76）进行修改，可按以下方法确定 $\Phi_{\mathrm{e}}(z)$ ：

1）若 $j \leqslant q$ ，则

$$
\Phi_{e}(z)=1-\Phi(z)=\left[\prod_{i=1}^{v-j}\left(1-a_{i} z^{-1}\right)\right]\left(1-z^{-1}\right)^{q} \Psi(z)
$$

（4-77）
2) 若 $j>q$, 则

$$
\Phi_{e}(z)=1-\Phi(z)=\left[\prod_{i=1}^{v-j}\left(1-a_{i} z^{-1}\right)\right]\left(1-z^{-1}\right)^{j} \Psi(z)
$$

（4-78）
2. $\Psi(z)$ 零点的选择
$\Phi(z)$ 的零点中，必须包含 $G(z)$ 在 $Z$ 平面单位圆外或圆上的所有零点，即

$$
\Phi(z)=z^{-(d+m-n)}\left[\prod_{i=1}^{u}\left(1-b_{i} z^{-1}\right)\right] F(z)
$$

（4-79）
式中, $F(z)$ 是关于 $z^{-1}$ 的待定多项式，且不含 $G(z)$ 中的不稳定零点 $b_{i}$ 。
$F(z)$ 具有以下形式

$$
F(z)=f_{0}+f_{1} z^{-1}+f_{2} z^{-2}+\cdots+f_{p} z^{-p}
$$

（4-80）
式中， $f_{0} 、 f_{1} 、 \cdots 、 f_{p}$ 为待定系数。
3. 待定多项式 $\boldsymbol{\Psi}(z)$ 和 $F(z)$ 阶次的确定

因 $\Phi_{r}(z)=1-\Phi(z)$ ，故 $\Phi_{r}(z)$ 和 $\Phi(z)$ 关于 $z^{-1}$ 的多项式阶次相同。对于足少折控即，式（4-76）中的 $k$ 是使 $\Phi_{\mathrm{e}}(z)$ 与 $\Phi(z)$ 阶次相同时的足小值，以此求取 $k$ 值。又因式（4-79）与（4-77）或与（4-78）的阶次相同，故有

1）若 $G(z)$ 中有 $j$ 个极点在单位圆上，当 $j \leqslant q$ 时，有

$$
\begin{array}{c}
p=q+v-j-u-d-m+n+k \\
F(z)=f_{0}+f_{1} z^{-1}+f_{2} z^{-2}+\cdots+f_{q+v-j-u-d-m+n+k} z^{-(q+v-j-u-d-m+n+k)}
\end{array}
$$

（4-81）
2）若 $G(z)$ 中有 $j$ 个极点在单位圆上, 当 $j>q$ 时, 有

$$
\begin{array}{c}
p=v-u-d-m+n+k \\
F(z)=f_{0}+f_{1} z^{-1}+f_{2} z^{-2}+\cdots+f_{v-u-d-m+n+k} z^{-(v-u-d-m+n+k)}
\end{array}
$$

（4-82）
4. $\boldsymbol{\Psi}(z)$ 和 $F(z)$ 中待定系数的确定
$\Psi(z)$ 和 $F(z)$ 阶次的确定以后，利用等式 $\Phi_{e}(z)=1-\Phi(z)$ 两边对应 $z^{-1}$ 指数项系数相等的方法求取 $\Psi(z)$ 和 $F(z)$ 中的待定系数。

以上给出了确定 $\Phi(z)$ 时必须满足的约束条件。根据此约束条件, 可求得最少拍控制器为

$$
D(z)=\frac{1 \quad \Phi(z)}{G(z) 1-\Phi(z)}=\left\{\begin{array}{l}
\frac{F(z)}{G^{\prime}(z)\left(1-z^{-1}\right)^{q-j} \Psi(z)}, j \leqslant q \\
\frac{F(z)}{G^{\prime}(z) \Psi(z)}, j>q
\end{array}\right.
$$

（4-83）
仅根据上述约束条件设计的最少拍控制系统，只保证了在最少的几个采样周期后系统的响应在采样点时是稳态误差为零, 而不能保证任意两个采样点之间的稳态误差为零。这种控制系统输出信号 $y(t)$ 有纹波存在, 故称为最少拍有纹波控制系统, 式 (4-83) 的控制器为最少拍有纹波控制器。 $y(t)$ 的纹波在采样点上观测不到, 要用修正 $Z$ 变换方能计算得出两个采样点之间的输出值，这种纹波称为隐蔽振荡（hidden oscillations）。

例 4-1 在图 4-17 所示的计算机控制系统中, 被控对象的传递函数和零阶保持器的传递函数分别为 $G_{\mathrm{c}}(s)=\frac{10}{s(s+1)}$ 和 $H(s)=\frac{1-\mathrm{e}^{-T s}}{s}$ 。采样周期 $T=1 \mathrm{~s}$, 试针对单位速度输人函数设计最少拍有纹波系统，画出数字控制器和系统的输出波形。

图4-17 计算机控制系统框图
解 首先求取广义对象的脉冲传递函数

$$
\begin{aligned}
G(z) & =Z\left[\frac{1-\mathrm{e}^{-T s}}{s} \frac{10}{s(s+1)}\right]=\left(1-z^{-1}\right) Z\left[\frac{10}{s^{2}(s+1)}\right] \\
& =10\left(1-z^{-1}\right)\left[\frac{z^{-1}}{\left(1-z^{-1}\right)^{2}}-\frac{1}{1-z^{-1}}+\frac{1}{1-0.3679 z^{-1}}\right] \\
& =\frac{3.679 z^{-1}\left(1+0.718 z^{-1}\right)}{\left(1-z^{-1}\right)\left(1-0.3679 z^{-1}\right)}
\end{aligned}
$$

上式中, $d=0, m=2, n=1, q=2, u=0, v=1, j=1$, 且 $j<q$ 。对单位速度输入信号, 根据式（4-76）选择 $k=0$ ，可使 $\Phi_{\mathrm{e}}(z)$ 与 $\Phi(z)$ 阶次相同。于是由式（4-77）得

$$
\Phi_{\mathrm{e}}(z)=1-\Phi(z)=\left[\prod_{i=1}^{v-j}\left(1-a_{i} z^{-1}\right)\right]\left(1-z^{-1}\right)^{q} \Psi(z)=\left(1-z^{-1}\right)^{2}
$$

依式（4-82）有

$$
F(z)=f_{0}+f_{1} z^{-1}
$$

由式（4-79）和式（4-82）得

$$
\Phi(z)=z^{-(d+m-n)}\left[\prod_{i=1}^{u}\left(1-b_{i} z^{-1}\right)\right] F(z)=z^{-1}\left(f_{0}+f_{1} z^{-1}\right)
$$

因为

$$
\Phi_{e}(z)=1-\Phi(z)
$$

所以

$$
\left(1-z^{-1}\right)^{2}=1-z^{-1}\left(f_{0}+f_{1} z^{-1}\right)
$$

由上式等号两边对应项的系数相等得

故

$$
\begin{array}{c}
\left\{\begin{array}{l}
f_{0}=2 \\
f_{1}=-1
\end{array}\right. \\
\Phi(z)=2 z^{-1}-z^{-2}
\end{array}
$$

$$
\begin{aligned}
D(z) & =\frac{1 \quad \Phi(z)}{G(z) (1-\Phi(z))}=\frac{\left(1-z^{-1}\right)\left(1-0.3679 z^{-1}\right)\left(2 z^{-1}-z^{-2}\right)}{3.679 z^{-1}\left(1+0.718 z^{-1}\right)\left(1-z^{-1}\right)^{2}} \\
& =\frac{0.5434\left(1-0.5 z^{-1}\right)\left(1-0.3679 z^{-1}\right)}{\left(1-z^{-1}\right)\left(1+0.718 z^{-1}\right)}
\end{aligned}
$$

进一步求得

$$
\begin{array}{c}
E(z)=\Phi_{\mathrm{e}}(z) R(z)=\left(1-z^{-1}\right)^{2} \frac{T z^{-1}}{\left(1-z^{-1}\right)^{2}}=z^{-1} \\
Y(z)=R(z) \Phi(z)=\frac{T z^{-1}}{\left(1-z^{-1}\right)^{2}}\left(2 z^{-1}-z^{-2}\right)=2 z^{-2}+3 z^{-3}+4 z^{-4}+\cdots \\
U(z)=E(z) D(z)=z^{-1} \frac{0.5434\left(1-0.5 z^{-1}\right)\left(1-0.3679 z^{-1}\right)}{\left(1-z^{-1}\right)\left(1+0.718 z^{-1}\right)} \\
=0.54 z^{-1}-0.32 z^{-2}+0.40 z^{-3}-0.12 z^{-4}+0.25 z^{-5}+\cdots
\end{array}
$$

由此, 可画出数字控制器和系统的输出波形, 如图 4-18a 和 b 所示。
a) 控制器输出
b）系统输出

图4-18 输出序列波形
4.2.4 最少拍无纹波控制器的设计

按最少拍有纹波系统设计的控制器，其系统的输出值跟踪输入值后，在非采样点有纹波存在。原因在于数字控制器的输出序列 $u(k)$ 经过若干拍后，不为常值或零，而是振荡收敛的。非采样时刻的纹波现象不仅造成非采样时刻有偏差，而且浪费执行机构的功率，增加机械磨损，因此必须消除。

1. 设计最少拍无纹波控制器的必要条件

无纹波系统要求系统的输出信号在采样点之间不出现纹波，必须满足：

1) 对阶跃输入，当 $t \geqslant N T$ 时，有 $y(t)=$ 常数。
2) 对速度输人，当 $t \geqslant N T$ 时，有 $\dot{y}(t)=$ 常数。

3）对加速度输入，当 $t \geqslant N T$ 时，有 $\ddot{y}(t)=$ 常数。
这样，被控对象 $G_{\mathrm{c}}(s)$ 必须有能力给出与系统输人 $r(t)$ 相同的且平滑的输出 $y(t)$ 。如果针对速度输人函数进行设计，那么稳态过程中 $G_{\mathrm{c}}(s)$ 的输出也必须是速度函数，为了产生这样的速度输出函数， $G_{\mathrm{c}}(s)$ 中必须至少有一个积分环节，使得控制信号 $u(k)$ 为常值（包括零) 时, $G_{\mathrm{o}}(s)$ 的稳态输出是所要求的速度函数。同理, 若针对加速度输人函数设计的无纹波控制器，则 $G_{\mathrm{c}}(s)$ 中必须至少有两个积分环节。因此，设计最少拍无纹波控制器时， $G_{\mathrm{c}}(s)$ 中必须含有足够的积分环节，以保证 $u(t)$ 为常数时， $G_{\mathrm{c}}(s)$ 的稳态输出完全跟踪输人，且无纹波。
2. 最少拍无纹波系统确定 $\Phi(z)$ 的约束条件

要使系统的稳态输出无纹波，就要求稳态时的控制信号 $u(k)$ 为常数或零。控制信号 $u(k)$ 的 $Z$ 变换为

$$
U(z)=\sum_{k=0}^{\infty} u(k) z^{-k}=u(0)+u(1) z^{-1}+\cdots+u(l) z^{-l}+u(l+1) z^{-(l+1)}+\cdots
$$

（4-84）
如果系统经过 $l$ 个采样周期到达稳态，无纹波系统要求 $u(l)=u(l+1)=u(l+2)=\cdots=$ 常数或零。

设广义对象 $G(z)$ 含有 $d$ 个采样周期的纯滞后

$$
G(z)=\frac{B(z)}{A(z)} z^{-d}
$$

（4-85）
而

$$
U(z)=\frac{Y(z)}{G(z)}=\frac{\Phi(z)}{G(z)} R(z)
$$

将式（4-85）代人上式, 得

$$
U(z)=\frac{\Phi(z)}{z^{-d} B(z)} A(z) R(z)=\Phi_{\mathrm{u}}(z) R(z)
$$

（4-86）
其中

$$
\Phi_{\mathrm{u}}(z)=\frac{\Phi(z)}{z^{-\mathrm{d}} B(z)} A(z)
$$

（4-87）
要使控制信号 $u(k)$ 在稳态过程中为常数或零，那么 $\Phi_{u}(z)$ 只能是关于 $z^{-1}$ 的有限多项式。因此式（4-87）中的 $\Phi(z)$ 必须包含 $G(z)$ 的分子多项式 $B(z)$ ，即 $\Phi(z)$ 必须包含 $G(z)$的所有零点。这样，原来最少拍有纹波系统设计时确定 $\Phi(z)$ 的公式（4-79）应修改为

$$
\Phi(z)=z^{-(d+m-n)}\left[\prod_{i=1}^{\omega}\left(1-b_{i} z^{-1}\right)\right] F(z)
$$

（4-88）
式中， $\omega$ 为 $G(z)$ 的所有零点数； $b_{1} 、 b_{2} 、 \cdots 、 b_{\omega}$ 为 $G(z)$ 的所有零点； $F(z)$ 是关于 $z^{-1}$ 的多项式，且不含 $G(z)$ 中的不稳定零点 $b_{i}$ 。
$F(z)$ 具有以下形式

$$
F(z)=f_{0}+f_{1} z^{-1}+f_{2} z^{-2}+\cdots+f_{p} z^{-p}
$$

（4-89）
式中， $f_{0} 、 f_{1} 、 \cdots 、 f_{p}$ 为待定系数。
3. 多项式 $\Psi(z)$ 和 $\boldsymbol{F}(z)$ 中阶次的确定

因 $\Phi_{e}(z)=1-\Phi(z)$, 故 $\Phi_{e}(z)$ 和 $\Phi(z)$ 关于 $z^{-1}$ 的多项式阶次相同。对于最少拍控制,式（4-76）中的 $k$ 是使 $\Phi_{e}(z)$ 与 $\Phi(z)$ 阶次相同时的最小值。又因式（4-79）与式（4-77）或与（4-88）的阶次相同，故有

待定系数 $f_{0} 、 f_{1} 、 \cdots 、 f_{p}$ 可由以下求得。
1）若 $G(z)$ 中有 $j$ 个极点在单位圆上, 当 $j \leqslant q$ 时, 有

$$
\begin{array}{c}
p=q+v-j-\omega-d-m+n+k \\
F(z)=f_{0}+f_{1} z^{-1}+f_{2} z^{-2}+\cdots+f_{q+p-j-\omega-d-m+n+k^{2}} z^{-(q+p-j-\omega-d-\infty+n+k)}
\end{array}
$$

（4-90）
2）若 $G(z)$ 中有 $j$ 个极点在单位圆上, 当 $j>q$ 时, 有

$$
\begin{array}{c}
p=v-\omega-d-m+n+k \\
F(z)=f_{0}+f_{1} z^{-1}+f_{2} z^{-2}+\cdots+f_{v-\omega-d-m+n+k} z^{-(v-\omega-d-m+n+k)}
\end{array}
$$

（4-91）
4. $\Psi(z)$ 和 $F(z)$ 中待定系数的确定
$\Psi(z)$ 和 $F(z)$ 阶次的确定以后, 利用等式 $\Phi_{e}(z)=1-\Phi(z)$ 两边对应 $z^{-1}$ 指数项系数相等的方法求取 $\Psi(z)$ 和 $F(z)$ 中的待定系数。
5. 无纹波系统的调整时间要增加若干拍, 增加的拍数等于 $G(z)$ 在单位圆内的零点数

例 4-2 在例 4-1 中，广义对象为 $(T=1 \mathrm{~s})$

$$
G(z)=\frac{3.679 z^{-1}\left(1+0.718 z^{-1}\right)}{\left(1-z^{-1}\right)\left(1-0.3679 z^{-1}\right)}
$$

试针对单位速度输入函数, 设计最少拍无纹波系统, 并绘出数字控制器和系统的输出波形图。

解 由 $G(z)$ 的表达式和 $G_{\mathrm{c}}(s)$ 可知, 满足无纹波设计的必要条件, 且 $d=0, m=2, n=$ $1, q=2, w=1, v=1, j=1$, 且 $j<q$ 。由于选择 $k=0$ 时, $1-\Phi(z) \neq \Phi_{\mathrm{e}}(z)$, 因此, 根据式（4-76） 只能选择最小 $k$ 的为 $k=1$, 于是由式 (4-77) 得

$$
\Phi_{e}(z)=1-\Phi(z)=\left[\prod_{i=1}^{v-j}\left(1-a_{i} z^{-1}\right)\right]\left(1-z^{-1}\right)^{q} \Psi(z)=\left(1-z^{-1}\right)^{2}\left(1+\psi_{1} z^{-1}\right)
$$

依式（4-90）有

$$
F(z)=f_{0}+f_{1} z^{-1}
$$

由式（4-88）和式（4-90）选择

因

$$
\Phi(z)=z^{-(d+m-n)}\left[\prod_{i=1}^{\omega}\left(1-b_{i} z^{-1}\right)\right] F(z)=z^{-1}\left(1+0.718 z^{-1}\right)\left(f_{0}+f_{1} z^{-1}\right)
$$

故 $\quad 1-f_{0} z^{-1}-\left(f_{1}+0.718 f_{0}\right) z^{-2}-0.718 f_{1} z^{-3}=1+\left(\psi_{1}-2\right) z^{-1}+\left(1-2 \psi_{1}\right) z^{-2}+\psi_{1} z^{-3}$

$$
\left\{\begin{array} { l } 
{ \psi _ { 1 } - 2 = - f _ { 0 } } \\
{ 1 - 2 \psi _ { 1 } = - ( f _ { 1 } + 0 . 7 1 8 f _ { 0 } ) } \\
{ \psi _ { 1 } = - 0 . 7 1 8 f _ { 1 } }
\end{array} \Rightarrow \left\{\begin{array}{l}
\psi_{1}=0.592 \\
f_{0}=1.408 \\
f_{1}=-0.825
\end{array}\right.\right.
$$

故有

$$
\begin{array}{c}
\Phi(z)=\left(1+0.718 z^{-1}\right)\left(1.408 z^{-1}-0.852 z^{-2}\right) \\
\Phi_{e}(z)=\left(1-z^{-1}\right)^{2}\left(1+0.592 z^{-1}\right)
\end{array}
$$

$$
\begin{aligned}
D(z) & =\frac{1 \quad \Phi(z)}{G(z) (1-\Phi(z))}=\frac{0.272\left(1-0.3679 z^{-1}\right)\left(1.408-0.825 z^{-1}\right)}{\left(1-z^{-1}\right)\left(1+0.592 z^{-1}\right)} \\
Y(z) & =R(z) \Phi(z)=\frac{T z^{-1}}{\left(1-z^{-1}\right)^{2}}\left(1+0.718 z^{-1}\right)\left(1.408 z^{-1}-0.825 z^{-2}\right) \\
& =1.41 z^{-2}+3 z^{-3}+4 z^{-4}+5 z^{-5}+\cdots \\
U(z)=\frac{Y(z)}{G(z)} & =\frac{R(z) \Phi(z)}{G(z)} \\
= & \frac{T z^{-1}}{\left(1-z^{-1}\right)^{2}}\left(1+0.718 z^{-1}\right)\left(1.408 z^{-1}-0.825 z^{-2}\right) \frac{\left(1-z^{-1}\right)\left(1-0.3679 z^{-1}\right)}{3.679 z^{-1}\left(1+0.718 z^{-1}\right)} \\
= & 0.38 z^{-1}+0.02 z^{-2}+0.09 z^{-3}+0.09 z^{-4}+\cdots
\end{aligned}
$$

数字控制器和系统的输出波形如图 4-19 所示。
a) 数字控制器输出
b) 系统输出
图 4-19 输出序列波形图

比较例 4-1 和例 4-2 的输出序列波形图可以看出, 有纹波系统的调整时间为两个采样周期，无纹波系统的调整时间为 3 个采样周期，比有纹波系统调整时间增加一拍，因为 $G(z)$在单位圆内有一个零点。
4.3 纯滞后控制技术

在工业过程（如热工、化工）控制中，由于物料或能量的传输延迟，许多被控制对象具有纯滞后性质。对象的这种纯滞后性质常引起系统产生超调或者振荡。早在 20 世纪 50 年代，国外就对工业生产过程中纯滞后对象进行了深入的研究。
4.3.1 施密斯（Smith）预估控制

施密斯提出了一种纯滞后补偿模型，但由于模拟仪表不能实现这种补偿，致使这种方法在工程中无法实现。现在人们利用微型计算机可以方便地实现纯滞后补偿。

1. 施密斯预估控制原理

在图 4-20 所示的带纯滞后环节的控制系统中， $D(s)$ 表示调节器的传递函数，用于校正 $G_{\mathrm{P}}(s)$ 部分; $G_{\mathrm{P}}(s) \mathrm{e}^{-\tau s}$ 表示被控对象的传递函数， $G_{\mathrm{P}}(s)$ 为被控制对象中不包含纯滞后部分的传递函数， $e^{-\tau s}$ 为被控制对象纯滞后部分的传递函数。

图 4-20 带纯滞后环节的控制系统
施密斯预估控制原理是：与 $D(s)$ 并接一补偿环节，用来补偿被控制对象中的纯滞后部分。这个补偿环节称为预估器，其传递函数为 $G_{\mathrm{P}}(s)\left(1-\mathrm{e}^{-\tau s}\right), \tau$ 为纯滞后时间，补偿后的系统框图如图 4-21 所示。

图 4-21 带施密斯预估器的控制系统
由施密斯预估器和调节器 $D(s)$ 组成的补偿回路称为纯滞后补偿器, 其传递函数为 $D^{\prime}(s)$, 即

$$
D^{\prime}(s)=\frac{D(s)}{1+D(s) G_{\mathrm{P}}(s)\left(1-\mathrm{e}^{-\tau s}\right)}
$$

经补偿后的系统闭环传递函数为

$$
\Phi(s)=\frac{D^{\prime}(s) G_{\mathrm{P}}(s) \mathrm{e}^{-\tau s}}{1+D^{\prime}(s) G_{\mathrm{P}}(s) \mathrm{e}^{-\tau s}}=\frac{D(s) G_{\mathrm{P}}(s)}{1+D(s) G_{\mathrm{P}}(s)} \mathrm{e}^{-\tau s}
$$

（4-92）

式（4-92）说明，经补偿后，消除了纯滞后部分对控制系统的影响，因为式中的 $\mathrm{e}^{-\tau}$ 在闭环控制回路之外，不影响系统的稳定性，拉普拉斯变换的位移定理说明， $\mathrm{e}^{-\tau{s}}$ 仅将控制作用在时间坐标上推移了一个时间 $\tau$, 控制系统的过渡过程及其他性能指标都与对象特性为 $G_{\mathrm{P}}(s)$ 时完全相同。
2. 具有纯滞后补偿的数字控制器

具有纯滞后补偿的控制系统如图 4-22 所示。由图4-22 可见，纯滞后补偿的数字控制器由两部分组成：一部分是数字 PID 控制器（由 $D(s)$ 离散化得到）；一部分是施密斯预估器

图4-22 具有纯滞后补偿的控制系统
（1）施密斯预估器
滞后环节使信号延迟，为此，在内存中专门设定 $N+1$ 个单元作为存放信号 $m(k)$ 的历史数据， $N$ 由下式决定：

$$
N=\tau / T
$$

式中， $\tau$ 为纯滞后时间； $T$ 为采样周期。
每采样一次，把 $m(k)$ 记入 0 单元，同时把 0 单元原来存放数据移到 1 单元， 1 单元原来存放数据移到 2 单元， $\cdots$ ，依此类推。从单元 $N$ 输出的信号，就是滞后 $N$ 个采样周期的 $m(k-N)$ 信号。

施密斯预估器的输出可按图 4-23 的顺序计算。

图4-23 施密斯预估器框图
图中, $u(k)$ 是 PID 数字控器的输出, $y_{\tau}(k)$ 是施密斯预估器的输出。从图中可知, 必须先计算传递函数 $G_{\mathrm{P}}(s)$ 的输出 $m(k)$ 后, 才能计算预估器的输出

$$
y_{\tau}(k)=m(k)-m(k-N)
$$

许多工业对象可近似用一阶惯性环节和纯滞后环节的串联来表示

$$
G_{\mathrm{c}}(s)=G_{\mathrm{P}}(s) \mathrm{e}^{-\tau{s}}=\frac{K_{\mathrm{f}}}{1+T_{\mathrm{f}} s} \mathrm{e}^{\mathrm{\tau s}}
$$

式中, $K_{\mathrm{f}}$ 为被控对象的放大系数; $T_{\mathrm{f}}$ 为被控对象的时间常数； $\tau$ 为纯滞后时间。
预估器的传递函数为

$$
G_{\tau}(s)=G_{\mathrm{P}}(s)\left(1-\mathrm{e}^{-\tau s}\right)=\frac{K_{\mathrm{f}}}{1+T_{\mathrm{f}}}\left(1-\mathrm{e}^{-\tau s}\right)
$$

（2）纯滞后补偿控制算法步骤
1）计算反馈回路的偏差 $e_{1}(k)$

$$
e_{1}(k)=r(k)-y(k)
$$

2) 计算纯滞后补偿器的输出 $y_{\tau}(k)$

$$
\frac{Y_{\tau}(s)}{U(s)}=G_{\mathrm{P}}(s)\left(1-\mathrm{e}^{-\tau s}\right)=\frac{K_{\mathrm{f}}\left(1-\mathrm{e}^{-N T_{s}}\right)}{T_{\mathrm{f}} s+1}
$$

化成微分方程式，则可写成

$$
T_{\mathrm{f}} \frac{\mathrm{~d} y_{\tau}(t)}{\mathrm{d} t}+y_{\tau}(t)=K_{\mathrm{f}}[u(t)-u(t-N T)]
$$

利用后向差分代替微分, 上式相应的差分方程为

$$
y_{\tau}(k)=a y_{\tau}(k-1)+b[u(k)-u(k-N)]
$$

（4-93）
式中， $a=\frac{T_{\mathrm{f}}}{T_{\mathrm{f}}+T}, b=K_{\mathrm{f}} \frac{T}{T_{\mathrm{f}}+T}$ 。式 (4-93) 称为腿密斯预估控制算式。
3）计算偏差 $e_{2}(k)$

$$
e_{2}(k)=e_{1}(k)-y_{\tau}(k)
$$

4）计算控制器的输出 $u(k)$
当控制器采用 PID 控制算法时，则

$$
\begin{aligned}
u(k)= & u(k-1)+\Delta u(k) \\
= & u(k-1)+K_{\mathrm{P}}\left[e_{2}(k)-e_{2}(k-1)\right]+K_{1} e_{2}(k) \\
& +K_{\mathrm{D}}\left[e_{2}(k)-2 e_{2}(k-1)+e_{2}(k-2)\right]
\end{aligned}
$$

式中， $K_{\mathrm{P}}$ 为 PID 控制的比例系数; $K_{\mathrm{I}}=K_{\mathrm{P}} T / T_{\mathrm{I}}$ 为积分系数; $K_{\mathrm{D}}=K_{\mathrm{p}} T_{\mathrm{D}} / T$ 为微分系数。

4.3.2 达林（Dahlin）算法

1. 数字控制器 $D(z)$ 的形式

被控对象 $G_{\mathrm{c}}(s)$ 是带有纯滞后的一阶或二阶惯性环节，即

$$
\begin{array}{c}
G_{\mathrm{c}}(s)=\frac{K}{1+T_{1} s} \mathrm{e}^{-\tau s} （4-94）\\
或 G_{\mathrm{c}}(s)=\frac{K}{\left(1+T_{1} s\right)\left(1+T_{2} s\right)} \mathrm{e}^{-\tau s} （4-95）
\end{array}
$$

式中 $\tau$ 为纯滞后时间； $T_{1} 、 T_{2}$ 为时间常数； $K$ 为放大系数。
达林算法的设计目标是使整个闭系统所期望的传递函数 $\Phi(s)$ 相当于一个延迟环节和一个惯性环节相串联，即

$$
\Phi(s)=\frac{1}{T_{\tau} s+1} \mathrm{e}^{-\tau s}
$$

（4-96）
并期望整个闭环系统的纯滞后时间和被控对象 $G_{\mathrm{c}}(s)$ 的纯滞后时间 $\tau$ 相同。式（4-96）中 $T_{\tau}$为闭环系统的时间常数, 纯滞后时间 $\tau$ 与采样周期 $T$ 有整数倍 $N$ 关系。

$$
\tau=N T
$$

用脉冲传递函数近似法求得与 $\Phi(s)$ 对应的闭环脉冲传递函数 $\Phi(z)$

$$
\Phi(z)=\frac{Y(z)}{R(z)}=Z\left[\frac{1-\mathrm{e}^{-\tau s}}{s} \cdot \frac{\mathrm{e}^{-\tau s}}{T_{\tau} s+1}\right]
$$

代入 $\tau=N T$ ，并进行 $Z$ 变换

$$
\Phi(z)=\frac{\left(1-\mathrm{e}^{-T / T_{\tau}}\right) z^{-N-1}}{1-\mathrm{e}^{-T / T_{\tau}} z^{-1}}
$$

（4-97）
由式（4-45）有

$$
\begin{aligned}
D(z) & =\frac{1}{G(z)} \frac{\Phi(z)}{1-\Phi(z)} \\
& =\frac{1}{G(z)} \frac{z^{-N-1}\left(1-\mathrm{e}^{-T / T_{\tau}}\right)}{1-\mathrm{e}^{-T / T_{\tau} z^{-1}-\left(1-\mathrm{e}^{-T / T_{\tau}}\right) z^{-N-1}}}
\end{aligned}
$$

（4-98）
假若已知被控对象的脉冲传递函数 $G(z)$ ，就可由式（4-98）求出数字控制器的脉冲传递函数 $D(z)$ 。

1）被控对象为带纯滞后的一阶惯性环节，其脉冲传递函数为

$$
G(z)=Z\left[\frac{1-\mathrm{e}^{-T_{s}}}{s} \cdot \frac{K \mathrm{e}^{-\tau_{s}}}{T_{1} s+1}\right]
$$

代以 $\tau=N T$, 得

$$
G(z)=Z\left[\frac{1-\mathrm{e}^{-T_{s}}}{s} \cdot \frac{K \mathrm{e}^{-\tau s}}{T_{1} s+1}\right]=K z^{-N-1} \frac{1-\mathrm{e}^{-T / T_{1}}}{1-\mathrm{e}^{-T / T_{1}} z^{-1}}
$$（式4-99）

将式（4-99）代人式（4-98）得到数字控制器的算式

$$
D(z)=\frac{\left(1-\mathrm{e}^{-T / T_{T}}\right)\left(1-\mathrm{e}^{-T / T_{1} z^{-1}}\right)}{K\left(1-\mathrm{e}^{-T / T_{1}}\right)\left[1-\mathrm{e}^{-T / T_{T} z^{-1}}-\left(1-\mathrm{e}^{-T / T_{T}}\right) z^{-N-1}\right]}
$$

2) 被控对象为带纯滞后的二阶惯性环节，其脉冲传递函数为

$$
G(z)=Z\left[\frac{1-\mathrm{e}^{-T_{s}}}{s} \cdot \frac{K e^{-\tau s}}{\left(T_{1} s+1\right)\left(T_{2} s+1\right)}\right]
$$

代以 $\tau=N T$, 并进行 $Z$ 变换, 得到

$$
\begin{array}{c}
G(z)=\frac{K\left(C_{1}+C_{2} z^{-1}\right) z^{-N-1}}{\left(1-\mathrm{e}^{-T / T_{1} z^{-1}}\right)\left(1-\mathrm{e}^{-T / T_{2} }z^{-1}\right)} （式4-100）\\
其中\left\{\begin{array}{l}
C_{1}=1+\frac{1}{T_{2}-T_{1}}\left(T_{1} \mathrm{e}^{-T / T_{1}}-T_{2} \mathrm{e}^{-T / T_{2}}\right) \\
C_{2}=\mathrm{e}^{-T\left(1 / T_{1}+1 / T_{2}\right)}+\frac{1}{T_{2}-T_{1}}\left(T_{1} \mathrm{e}^{-T / T_{2}}-T_{2} \mathrm{e}^{-T / T_{1}}\right)
\end{array}\right.(式4-101)
\end{array}
$$

将式（4-100）代入式（4-98）得

$$
D(z)=\frac{\left(1-\mathrm{e}^{-T / T_{\tau}}\right)\left(1-\mathrm{e}^{T / T_{1}} z^{-1}\right)\left(1-\mathrm{e}^{-T / T_{2} }z^{-1}\right)}{K\left(C_{1}+C_{2} z^{-1}\right)\left[1-\mathrm{e}^{T / T_{\tau}} z^{-1}-\left(1-\mathrm{e}^{-T / T_{\tau}}\right) z^{-N-1}\right]}
$$

2. 振铃现象及其消除

所谓振铃（Ringing）现象，是指数字控制器的输出以二分之一采样频率大幅度衰减的振荡。这与前面所介绍的快速有纹波系统中的纹波是不一样的。纹波是由于控制器输出一直是振荡的，影响到系统的输出一直有纹波。而振䍅现象中的振荡是衰减的。由于被控对象中惯性环节的低通特性，使得这种振荡对系统的输出几乎无任何影响。但是振铃现象却会增加执行机构的磨损，在有交互作用的多参数控制系统中，振铃现象还有可能影响到系统的稳定性。
（1）振䍅现象的分析
如图 4-14 所示，系统的输出 $Y(z)$ 和数字控制器的输出 $U(z)$ 间有下列关系：

$$
Y(z)=U(z) G(z)
$$

系统的输出 $Y(z)$ 和输入函数的 $R(z)$ 之间有下列关系:

$$
Y(z)=R(z) \Phi(z)
$$

由上面两式得到数字控制器的输出 $U(z)$ 与输入函数的 $R(z)$ 之间的关系：

$$
\begin{array}{l}
\frac{U(z)}{R(z)}=\frac{\Phi(z)}{G(z)} （4-102） \\
\Phi_{u}(z)=\frac{\Phi(z)}{G(z)} （4-103）
\end{array}
$$

显然可由式（4-102）得到

$$
U(z)=\Phi_{u}(z) R(z)
$$

$\Phi_{u}(z)$ 表达了数字控制器的输出与输入函数在闭环时的关系，是分析振铃现象的基础。
对于单位阶跃输入函数 $R(z)=1 /\left(1-z^{-1}\right)$, 含有极点 $z=1$, 如果 $\Phi_{u}(z)$ 的极点在 $Z$ 平面的负实轴上，且与 $z=-1$ 点相近，那么数字控制器的输出序列 $u(k)$ 中将含有这两种幅值相近的瞬态项，而且瞬态项的符号在不同时刻是不相同的。当两瞬态项符号相同时，数字控制器的输出控制作用加强，符号相反时，控制作用减弱，从而造成数字控制器的输出序列大幅度波动。分析 $\Phi_{u}(z)$ 在 $z$ 平面负实轴上的极点分布情况，就可得出振铃现象的有关结论。下面分析带纯滞后的一阶或二阶惯性环节系统中的振铃现象。

1）带纯滞后的一阶惯性环节
被控对象为带纯滞后的一阶惯性环节时，其脉冲传递函数 $G(z)$ 为式（4-99），闭环系统的期望传递函数为式（4-97），将二式代人式（4-103），有

$$
\Phi_{u}(z)=\frac{\Phi(z)}{G(z)}=\frac{\left(1-\mathrm{e}^{-T / T_{\tau}}\right)\left(1-\mathrm{e}^{-T / T_{1}} z^{-1}\right)}{K\left(1-\mathrm{e}^{-T / T_{1}}\right)\left(1-\mathrm{e}^{-T / T_{\tau}} z^{-1}\right)}
$$

（4-104）
求得极点 $z=e^{-T / T_{\tau}}$, 显然 $z$ 永远是大于零的。故得出结论: 在带纯滞后的一阶惯性环节组成的系统中, 数字控制器输出对输人的脉冲传递函数不存在负实轴上的极点, 这种系统不存在振䍅现象。

2）带纯滞后的二阶惯性环节
被控制对象为带纯滞后的二阶惯性环节时，其脉冲传递函数 $G(z)$ 为式（4-100），闭环系统的期望传递函数仍为式（4-97），把二式代人式（4-103）后有

$$
\Phi_{u}(z)=\frac{\Phi(z)}{G(z)}=\frac{\left(1-\mathrm{e}^{-T / T_{\tau}}\right)\left(1-\mathrm{e}^{-T / T_{1}} z^{-1}\right)\left(1-\mathrm{e}^{-T / T_{2}} z^{-1}\right)}{K C_{1}\left(1-\mathrm{e}^{-T / T_{\tau}} z^{-1}\right)\left(1+\frac{C_{2}}{C_{1}} z^{-1}\right)}
$$

式 (4-105) 有两个极点, 第一个极点在 $z=\mathrm{e}^{-T / T_{\tau}}$, 不会引起振䍅现象; 第二个极点在 $z=$ $-\frac{C_{2}}{C_{1}}$ 。由式（4-101），在 $T \rightarrow 0$ 时，有

$$
\lim _{T \rightarrow 0}\left(-\frac{C_{2}}{C_{1}}\right)=-1
$$

说明可能出现负实轴上与 $z=-1$ 相近的极点, 这一极点将引起振铃现象。

(2) 振铃幅度 $R A$

振铃幅度 $R A$ 用来衡量振铃强烈的程度。为了描述振铃强烈的程度，应找出数字控制器输出量的最大值 $u_{\text {max }}$ 。由于这一最大值与系统参数的关系难于用解析的式子描述出来, 所以常用单位阶跃作用下数字控制器第 0 次输出量与第一次输出量的差值来衡量振铃现象强烈的程度。

由式 (4-103), $\Phi_{u}(z)=\Phi(z) / G(z)$ 是 $z$ 的有理分式, 写成一般形式为

$$
\Phi_{u}(z)=\frac{1+b_{1} z^{-1}+b_{2} z^{-2}+\cdots}{1+a_{1} z^{-1}+a_{2} z^{-2}+\cdots}
$$

（4-106）
在单位阶跃输入函数的作用下, 数字控制器输出量的 $Z$ 变换是

$$
\begin{aligned}
U(z) & =R(z) \Phi_{u}(z)=\frac{1}{1-z^{-1}} \cdot \frac{1+b_{1} z^{-1}+b_{2} z^{-2}+\cdots}{1+a_{1} z^{-1}+a_{2} z^{-2}+\cdots} \\
& =\frac{1+b_{1} z^{-1}+b_{2} z^{-2}+\cdots}{1+\left(a_{1}-1\right) z^{-1}+\left(a_{2}-a_{1}\right) z^{-2}+\cdots} \\
& =1+\left(b_{1}-a_{1}+1\right) z^{-1}+\cdots
\end{aligned}
$$

所以

$$
R A=1-\left(b_{1}-a_{1}+1\right)=a_{1}-b_{1}
$$

（4-107）
对于带纯滞后的二阶惯性环节组成的系统，其振铃幅度由式（4-105）可得

$$
R A=\frac{C_{2}}{C_{1}}-\mathrm{e}^{-T / T_{\tau}}+\mathrm{e}^{-T / T_{1}}+\mathrm{e}^{-T / T_{2}}
$$

（4-108）
根据式（4-101）及式（4-108）, 当 $T \rightarrow 0$ 时, 可得

$$
\lim _{T \rightarrow 0} R A=2
$$

（3）振铃现象的消除
有两种方法可用来消除振铃现象。第一种方法是先找出 $D(z)$ 中引起振䍅现象的因子 $(z=-1$ 附近的极点), 然后令其中的 $z=1$, 根据终值定理, 这样处理不影响输出量的稳态值。下面具体说明这种处理方法。

前面已介绍在带纯滞后的二阶惯性环节系统中，数字控制器的 $D(z)$ 为

$$
D(z)=\frac{\left(1-\mathrm{e}^{-T / T_{\tau}}\right)\left(1-\mathrm{e}^{-T / T_{1}} z^{-1}\right)\left(1-\mathrm{e}^{-T / T_{2}} z^{-1}\right)}{K\left(C_{1}+C_{2} z^{-1}\right)\left[1-\mathrm{e}^{-T / T_{\tau}} z^{-1}-\left(1-\mathrm{e}^{-T / T_{\tau}}\right) z^{-N-1}\right]}
$$

其极点 $z=-\frac{C_{2}}{C_{1}}$ 将引起振䍅现象。令极点因子 $\left(C_{1}+C_{2} z^{-1}\right)$ 中的 $z=1$, 就可消除这个振铃极点。由式 $(4-101)$ 得 $C_{1}+C_{2}=\left(1-\mathrm{e}^{-T / T_{1}}\right)\left(1-\mathrm{e}^{-T / T_{2}}\right)$
消除振铃极点 $z=-C_{2} / C_{1}$ 后, 有

$$
D(z)=\frac{\left(1-\mathrm{e}^{-T / T_{\tau}}\right)\left(1-\mathrm{e}^{-T / T_{1}} z^{-1}\right)\left(1-\mathrm{e}^{-T / T_{2}} z^{-1}\right)}{K\left(1-\mathrm{e}^{-T / T_{1}}\right)\left(1-\mathrm{e}^{-T / T_{2}}\right)\left[1-\mathrm{e}^{-T / T_{\tau}} z^{-1}-\left(1-\mathrm{e}^{-T / T_{\tau}}\right) z^{-N-1}\right]}
$$

这种消除振铃现象的方法虽然不影响输出稳态值，但却改变了数字控制器的动态特性，将影响闭环系统的瞬态性能。

第二种方法是从保证闭环系统的特性出发, 选择合适的采样周期 $T$ 及系统闭环时间常数 $T_{\tau}$, 使得数字控制器的输出避免产生强烈的振䍅现象。从式（4-108）中可以看出，带纯滞后的二阶惯性环节组成的系统中，振铃幅度与被控对象的参数 $T_{1} 、 T_{2}$ 有关，与闭环系统期望的时间常数 $T_{\tau}$ 以及采样周期 $T$ 有关。通过适当选择 $T$ 和 $T_{\tau}$, 可以把振铃幅度抑制在最低限度以内。有的情况下, 系统闭环时间常数 $T_{\tau}$ 作为控制系统的性能指标被首先确定了, 但仍可通过式（4-108）选择采样周期 $T$ 来抑制振铃现象。
3. 达林算法的设计步骤
具有纯滞后系统中直接设计数字控制器所考虑的主要性能是控制系统不允许产生超调并要求系统稳定。系统设计中一个值得注意的问题是振铃现象。下面是考虑振铃现象影响时设计数字控制器的一般步骤。
1）根据系统的性能，确定闭环系统的参数 $T_{T}$ ，给出振铃幅度 $R A$ 的指标。
2）由式（4-108）所确定的振铃幅度 $R A$ 与采样周期 $T$ 的关系，解出给定振铃幅度下对应的采样周期, 如果 $T$ 有多解, 则选择较大的采样周期。
3）确定纯滞后时间 $\tau$ 与采样周期 $T$ 之比 $(\tau / T)$ 的最大整数 $N$ 。
4）求广义对象的脉冲传递函数 $G(z)$ 及闭环系统的脉冲传递函数 $\Phi(z)$ 。
5) 求数字控制器的脉冲传递函数 $D(z)$ 。

